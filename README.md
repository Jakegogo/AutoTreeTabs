# Auto Tree Tabs - Chrome 插件

一个类似 Tabs Outliner 的 Chrome 插件，能够跟踪用户点击链接并生成标签页树结构。

## 功能特性

1. **链接跟踪**: 自动跟踪用户点击链接的行为，建立标签页之间的父子关系
2. **树形展示**: 在弹出窗口中以树形结构显示所有标签页
3. **批量选择**: 点击父节点可以选中自身和所有子标签页
4. **快速关闭**: 每个树节点都有关闭按钮，支持一键关闭
5. **级联关闭**: 关闭父节点时会同时关闭所有子节点

## 安装步骤

### 开发者模式安装

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/` 并回车
3. 在右上角启用"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本项目的文件夹
6. 插件安装完成

## 使用方法

### 基本使用

1. **启动插件**: 点击浏览器工具栏中的插件图标
2. **查看树结构**: 弹出窗口会显示当前所有标签页的树形关系
3. **刷新数据**: 点击"Refresh"按钮更新树结构

### 树形操作

- **选择标签页**: 点击任意节点来选择该标签页及其所有子标签页
- **激活标签页**: 单独选择一个标签页时会自动切换到该标签页
- **关闭标签页**: 点击节点右侧的红色 × 按钮关闭标签页
- **批量关闭**: 关闭父节点会同时关闭其所有子节点

### 自动跟踪

插件会自动跟踪以下链接打开行为：

- 点击带有 `target="_blank"` 的链接
- Ctrl+点击 (Windows) 或 Cmd+点击 (Mac) 链接
- 中键点击链接
- 右键菜单中的"在新标签页中打开"

## 文件结构

```
AutoTreeTabs/
├── manifest.json       # 插件配置文件
├── popup.html          # 弹出窗口HTML
├── popup.js            # 弹出窗口逻辑
├── background.js       # 后台服务脚本
├── content.js          # 内容脚本
├── icon.svg            # 插件图标
└── README.md           # 说明文档
```

## 技术实现

### 核心组件

1. **Background Script**: 监听标签页创建/删除事件，维护标签页关系
2. **Content Script**: 在网页中监听链接点击事件
3. **Popup Interface**: 提供用户交互界面

### 数据存储

使用 Chrome Storage API 存储标签页关系数据：

```javascript
// 数据结构示例
{
  "tabRelations": {
    "123": 456,  // 标签页123的父标签页是456
    "124": 456,  // 标签页124的父标签页是456
    "125": 123   // 标签页125的父标签页是123
  }
}
```

### 权限说明

- `tabs`: 访问标签页信息
- `storage`: 存储标签页关系数据
- `activeTab`: 获取当前活动标签页

## 开发说明

### 调试方法

1. 在 `chrome://extensions/` 页面找到插件
2. 点击"详细信息"
3. 启用"收集错误"
4. 查看控制台输出进行调试

### 修改代码

修改代码后需要：
1. 在扩展程序页面点击刷新按钮
2. 或者重新加载扩展程序

## 注意事项

- 插件需要在所有网站上运行以跟踪链接点击
- 标签页关系数据存储在本地，不会同步到其他设备
- 关闭浏览器后标签页关系数据会保留

## 故障排除

### 常见问题

1. **树结构不显示**
   - 检查是否有标签页打开
   - 尝试点击刷新按钮

2. **链接跟踪不工作**
   - 确认插件有权限访问当前网站
   - 检查浏览器控制台是否有错误信息

3. **关闭按钮无效**
   - 某些系统标签页（如扩展程序页面）可能无法关闭
   - 尝试刷新树结构

## 版本信息

- 版本: 1.0
- 兼容性: Chrome Manifest V3
- 支持平台: Windows, macOS, Linux
