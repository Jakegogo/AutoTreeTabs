{
  "version": 3,
  "sources": ["modules/state.js", "modules/layout.js", "modules/favicon-ui.js", "modules/file-types.js", "modules/bookmarks.js", "modules/selection.js", "modules/tab-actions.js", "modules/tree.js", "modules/search.js", "modules/debug.js", "popup-main.js"],
  "sourcesContent": ["// \u5171\u4EAB\u53EF\u53D8\u72B6\u6001\r\nexport const state = {\r\n  // \u591A\u9009\r\n  selectedTabIds: new Set(),\r\n  currentTabId: null,\r\n\r\n  // \u6811\u52A0\u8F7D\u63A7\u5236\r\n  lastRestoreTime: 0,\r\n  RESTORE_COOLDOWN: 3000,\r\n\r\n  // \u7F13\u5B58\r\n  pinnedTabsCache: {},\r\n  tabGroupInfo: {},\r\n  bookmarkCache: new Map(),\r\n  bookmarkedUrlsSet: null,\r\n\r\n  // \u8FC7\u6EE4\u5668\u4E0E\u641C\u7D22\r\n  selectedFilters: { bookmarked: false, recent: false, historyTerm: null, lastRecent: false },\r\n  searchHistory: [],\r\n  suppressAutoSearchOnce: false,\r\n  isRefreshingByRecent: false,\r\n  currentSearchTerm: '',\r\n\r\n  // favicon\r\n  __faviconHydrateScheduled: false,\r\n};\r\n", "// ===================\r\n// \u5E03\u5C40\uFF1A\u8BA1\u7B97 tree-container \u9AD8\u5EA6\r\n// ===================\r\n\r\nexport function calculateTreeHeight() {\r\n  const treeContainer = document.getElementById('treeContainer');\r\n  if (!treeContainer) return;\r\n\r\n  const bodyHasScrollbar = document.body.scrollHeight > document.body.clientHeight + 10;\r\n  console.log('bodyScrollHeight', document.body.scrollHeight, 'bodyClientHeight', document.body.clientHeight);\r\n  const htmlHasScrollbar = document.documentElement.scrollHeight > document.documentElement.clientHeight + 10;\r\n  console.log('htmlScrollHeight', document.documentElement.scrollHeight, 'htmlClientHeight', document.documentElement.clientHeight);\r\n\r\n  if (!bodyHasScrollbar && !htmlHasScrollbar) {\r\n    console.log('\uD83D\uDCCF No scrollbar detected, skipping height calculation');\r\n    return;\r\n  }\r\n\r\n  console.log('\uD83D\uDCCF Scrollbar detected, calculating optimal height...');\r\n\r\n  const popupHeight = window.innerHeight || document.body.offsetHeight || 600;\r\n  let usedHeight = 0;\r\n\r\n  const bodyStyle = getComputedStyle(document.body);\r\n  usedHeight += parseInt(bodyStyle.paddingTop) + parseInt(bodyStyle.paddingBottom);\r\n\r\n  const header = document.querySelector('.header');\r\n  if (header) {\r\n    usedHeight += header.offsetHeight;\r\n    const headerStyle = getComputedStyle(header);\r\n    usedHeight += parseInt(headerStyle.marginBottom) + parseInt(headerStyle.paddingBottom);\r\n  }\r\n\r\n  const searchContainer = document.querySelector('.search-container');\r\n  if (searchContainer) {\r\n    usedHeight += searchContainer.offsetHeight;\r\n    const searchStyle = getComputedStyle(searchContainer);\r\n    usedHeight += parseInt(searchStyle.marginBottom);\r\n  }\r\n\r\n  const availableHeight = popupHeight - usedHeight - 30 - 24;\r\n  const finalHeight = Math.max(200, Math.min(500, availableHeight));\r\n\r\n  treeContainer.style.maxHeight = `${finalHeight}px`;\r\n\r\n  console.log('\uD83D\uDCD0 Height calculation:', {\r\n    popupHeight,\r\n    usedHeight,\r\n    availableHeight,\r\n    finalHeight: finalHeight + 'px'\r\n  });\r\n}\r\n", "// ===================\r\n// Favicon \u663E\u793A\u903B\u8F91\uFF08popup \u7AEF\uFF09\r\n// ===================\r\nimport { state } from './state.js';\r\n\r\n// \u9A8C\u8BC1favicon URL\u662F\u5426\u5B89\u5168\u53EF\u7528\r\nexport function isValidFaviconUrl(url) {\r\n  if (!url || typeof url !== 'string') {\r\n    return false;\r\n  }\r\n\r\n  // \u963B\u6B62chrome\u534F\u8BAE\u548C\u6269\u5C55\u534F\u8BAE\r\n  if (url.startsWith('chrome://') ||\r\n      url.startsWith('chrome-extension://') ||\r\n      url.startsWith('moz-extension://') ||\r\n      url.startsWith('safari-extension://')) {\r\n    return false;\r\n  }\r\n\r\n  // \u53EA\u5141\u8BB8\u5B89\u5168\u7684\u534F\u8BAE\r\n  if (url.startsWith('https://') ||\r\n      url.startsWith('http://') ||\r\n      url.startsWith('data:') ||\r\n      url.startsWith('blob:')) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function setIconPlaceholder(iconEl, enabled) {\r\n  if (!iconEl) return;\r\n  if (enabled) {\r\n    iconEl.classList.add('icon-placeholder');\r\n    // \u91CD\u8981\uFF1A\u4E0D\u8981\u7528 inline backgroundColor \u8986\u76D6\u5360\u4F4D\u6837\u5F0F\uFF08inline \u4F18\u5148\u7EA7\u6700\u9AD8\uFF09\r\n    iconEl.style.backgroundColor = '';\r\n  } else {\r\n    iconEl.classList.remove('icon-placeholder');\r\n  }\r\n}\r\n\r\nexport function applyIconBackground(iconEl, url, source, bgColor = 'transparent') {\r\n  if (!iconEl) return;\r\n  if (source) iconEl.dataset.faviconSource = source;\r\n\r\n  // \u672A\u63D0\u4F9B/\u975E\u6CD5 URL\uFF1A\u4FDD\u6301\u5360\u4F4D\r\n  if (!url || !isValidFaviconUrl(url)) {\r\n    setIconPlaceholder(iconEl, true);\r\n    iconEl.style.backgroundImage = '';\r\n    return;\r\n  }\r\n\r\n  // \u5148\u5C55\u793A\u5360\u4F4D\uFF08\u5706\u89D2\u77E9\u5F62\uFF09\uFF0C\u5F85\u56FE\u7247\u771F\u6B63\u52A0\u8F7D\u6210\u529F\u540E\u518D\u53D6\u6D88\u5706\u89D2/\u80CC\u666F\r\n  setIconPlaceholder(iconEl, true);\r\n\r\n  const img = new Image();\r\n  img.onload = () => {\r\n    // \u82E5 DOM \u5DF2\u88AB\u79FB\u9664\u5219\u8DF3\u8FC7\r\n    if (!iconEl.isConnected) return;\r\n    iconEl.style.backgroundImage = `url(\"${url}\")`;\r\n    iconEl.style.backgroundColor = bgColor || 'transparent';\r\n    setIconPlaceholder(iconEl, false);\r\n  };\r\n  img.onerror = () => {\r\n    // \u52A0\u8F7D\u5931\u8D25\uFF1A\u4FDD\u7559\u5360\u4F4D\r\n    if (!iconEl.isConnected) return;\r\n    iconEl.style.backgroundImage = '';\r\n    setIconPlaceholder(iconEl, true);\r\n  };\r\n  img.src = url;\r\n}\r\n\r\nasync function hydrateIconsAfterFaviconCacheLoaded() {\r\n  const cache = window.FaviconCacheV1;\r\n  if (!cache) return;\r\n\r\n  await cache.ensureLoaded();\r\n\r\n  const nodes = document.querySelectorAll('.tree-node');\r\n  for (const nodeEl of nodes) {\r\n    const iconEl = nodeEl.querySelector('.tree-icon');\r\n    if (!iconEl) continue;\r\n    if (iconEl.dataset.faviconSource === 'filetype') continue;\r\n\r\n    const tabUrl = nodeEl.dataset.tabUrl || '';\r\n    const favIconUrl = nodeEl.dataset.favIconUrl || '';\r\n\r\n    const entry = await cache.getCachedEntryForPageUrl(tabUrl);\r\n    const hasFreshData = entry && !entry.negative && entry.dataUrl && entry.dataUrl.startsWith('data:') && ((Date.now() - (entry.ts || 0)) <= cache.TTL_MS);\r\n    if (hasFreshData && isValidFaviconUrl(entry.dataUrl)) {\r\n      applyIconBackground(iconEl, entry.dataUrl, 'storage_data');\r\n      continue;\r\n    }\r\n\r\n    // fallback to show something (may trigger network), then try to refresh cache in background (within popup lifetime)\r\n    if (favIconUrl && isValidFaviconUrl(favIconUrl)) {\r\n      applyIconBackground(iconEl, favIconUrl, 'favIconUrl');\r\n    } else {\r\n      iconEl.dataset.faviconSource = iconEl.dataset.faviconSource || 'placeholder';\r\n      // \u4FDD\u6301\u5360\u4F4D\u80CC\u666F\r\n      iconEl.classList.add('icon-placeholder');\r\n    }\r\n\r\n    // Update cache (popup-side fetch + persist)\r\n    iconEl.dataset.faviconSource = iconEl.dataset.faviconSource || 'requested';\r\n    const result = await cache.getFaviconDataUrl(tabUrl, favIconUrl || null);\r\n    iconEl.dataset.faviconSource = result?.source || 'unknown';\r\n    if (result?.dataUrl && isValidFaviconUrl(result.dataUrl) && iconEl.isConnected) {\r\n      applyIconBackground(iconEl, result.dataUrl, result.source || 'unknown');\r\n    }\r\n  }\r\n}\r\n\r\nexport function scheduleFaviconHydrate() {\r\n  // \u5173\u952E\uFF1A\u5FC5\u987B\u5728 renderTree \u628A DOM \u8282\u70B9 append \u5B8C\u4E4B\u540E\u518D\u8DD1\uFF0C\u5426\u5219 querySelectorAll('.tree-node') \u4E3A\u7A7A\r\n  if (state.__faviconHydrateScheduled) return;\r\n  state.__faviconHydrateScheduled = true;\r\n  setTimeout(async () => {\r\n    state.__faviconHydrateScheduled = false;\r\n    try {\r\n      await hydrateIconsAfterFaviconCacheLoaded();\r\n    } catch (e) {\r\n      // \u907F\u514D\u5F71\u54CD\u4E3B\u6D41\u7A0B\uFF1A\u56FE\u6807\u5931\u8D25\u4E0D\u5E94\u5F71\u54CD popup \u529F\u80FD\r\n      console.warn('Favicon hydrate failed:', e);\r\n    }\r\n  }, 0);\r\n}\r\n", "// ===================\r\n// \u6587\u4EF6\u7C7B\u578B\u68C0\u6D4B\u7CFB\u7EDF\r\n// ===================\r\n\r\n/**\r\n * \u6587\u4EF6\u7C7B\u578B\u914D\u7F6E\r\n * \u6BCF\u4E2A\u6587\u4EF6\u7C7B\u578B\u5305\u542B\uFF1A\u68C0\u6D4B\u89C4\u5219\u3001\u56FE\u6807\u6587\u4EF6\u540D\u3001\u663E\u793A\u540D\u79F0\u3001\u6837\u5F0F\u914D\u7F6E\r\n */\r\nexport const FILE_TYPE_CONFIG = {\r\n  pdf: {\r\n    extensions: ['.pdf'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-pdf.svg',\r\n    title: 'pdfFile',\r\n    bgColor: 'transparent'\r\n  },\r\n  html: {\r\n    extensions: ['.html', '.htm'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-html.svg',\r\n    title: 'htmlFile',\r\n    bgColor: 'transparent'\r\n  },\r\n  png: {\r\n    extensions: ['.png'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-png.svg',\r\n    title: 'imageFile',\r\n    bgColor: 'transparent'\r\n  },\r\n  jpg: {\r\n    extensions: ['.jpg', '.jpeg'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-jpg.svg',\r\n    title: 'imageFile',\r\n    bgColor: 'transparent'\r\n  },\r\n  svg: {\r\n    extensions: ['.svg'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-svg.svg',\r\n    title: 'imageFile',\r\n    bgColor: 'transparent'\r\n  },\r\n  markdown: {\r\n    extensions: ['.md', '.markdown'],\r\n    protocols: ['file://', 'chrome-extension://'],\r\n    icon: 'assets/icon-md.svg',\r\n    title: 'markdownFile',\r\n    bgColor: 'transparent'\r\n  },\r\n};\r\n\r\n/**\r\n * \u68C0\u6D4BURL\u662F\u5426\u4E3A\u7279\u5B9A\u6587\u4EF6\u7C7B\u578B\r\n * @param {string} url - \u8981\u68C0\u6D4B\u7684URL\r\n * @returns {string|null} \u6587\u4EF6\u7C7B\u578B\u540D\u79F0\uFF0C\u5982\u679C\u4E0D\u5339\u914D\u5219\u8FD4\u56DEnull\r\n */\r\nexport function detectFileType(url) {\r\n  if (!url || typeof url !== 'string') {\r\n    return null;\r\n  }\r\n\r\n  // \u89E3\u7801URL\u4EE5\u5904\u7406\u7F16\u7801\u7684\u5B57\u7B26\uFF08\u5982\u4E2D\u6587\u8DEF\u5F84\uFF09\r\n  // \u6CE8\u610F\uFF1A\u67D0\u4E9B\u9875\u9762/\u672C\u5730\u8DEF\u5F84\u53EF\u80FD\u5305\u542B\u975E\u6CD5\u7684 \"%\" \u7F16\u7801\uFF0CdecodeURIComponent \u4F1A\u629B URIError\u3002\r\n  // \u8FD9\u91CC\u505A\u5BB9\u9519\uFF0C\u907F\u514D\u5355\u4E2A\u5F02\u5E38 URL \u5BFC\u81F4\u6574\u68F5\u6811\u6E32\u67D3/\u521D\u59CB\u5316\u4E2D\u65AD\uFF08\u8FDB\u800C\u5F71\u54CD tagSuggestions \u7B49 UI\uFF09\u3002\r\n  let decodedUrl = url;\r\n  try {\r\n    decodedUrl = decodeURIComponent(url);\r\n  } catch {\r\n    decodedUrl = url;\r\n  }\r\n  const lowerUrl = decodedUrl.toLowerCase();\r\n\r\n  // \u904D\u5386\u6240\u6709\u6587\u4EF6\u7C7B\u578B\u914D\u7F6E\r\n  for (const [fileType, config] of Object.entries(FILE_TYPE_CONFIG)) {\r\n    // \u68C0\u67E5\u662F\u5426\u6709\u5339\u914D\u7684\u534F\u8BAE\r\n    const hasMatchingProtocol = config.protocols.some(protocol =>\r\n      lowerUrl.includes(protocol.toLowerCase())\r\n    );\r\n\r\n    // \u68C0\u67E5\u662F\u5426\u6709\u5339\u914D\u7684\u6269\u5C55\u540D\r\n    const hasMatchingExtension = config.extensions.some(ext =>\r\n      lowerUrl.includes(ext.toLowerCase())\r\n    );\r\n\r\n    if (hasMatchingProtocol && hasMatchingExtension) {\r\n      return fileType;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * \u83B7\u53D6\u6587\u4EF6\u7C7B\u578B\u914D\u7F6E\r\n * @param {string} fileType - \u6587\u4EF6\u7C7B\u578B\u540D\u79F0\r\n * @returns {object|null} \u6587\u4EF6\u7C7B\u578B\u914D\u7F6E\u5BF9\u8C61\r\n */\r\nexport function getFileTypeConfig(fileType) {\r\n  return FILE_TYPE_CONFIG[fileType] || null;\r\n}\r\n\r\n/**\r\n * \u68C0\u6D4B\u662F\u5426\u4E3APDF\u6587\u4EF6\uFF08\u4FDD\u6301\u5411\u540E\u517C\u5BB9\uFF09\r\n * @param {string} url - \u8981\u68C0\u6D4B\u7684URL\r\n * @returns {boolean} \u662F\u5426\u4E3APDF\u6587\u4EF6\r\n */\r\nexport function isPdfUrl(url) {\r\n  return detectFileType(url) === 'pdf';\r\n}\r\n", "// ===================\r\n// \u4E66\u7B7E\u67E5\u8BE2\r\n// ===================\r\nimport { state } from './state.js';\r\n\r\nexport async function getAllBookmarkedUrlSet() {\r\n  if (state.bookmarkedUrlsSet) return state.bookmarkedUrlsSet;\r\n  try {\r\n    const tree = await chrome.bookmarks.getTree();\r\n    const set = new Set();\r\n    const stack = [...tree];\r\n    while (stack.length) {\r\n      const node = stack.pop();\r\n      if (!node) continue;\r\n      if (node.url) {\r\n        try {\r\n          const u = new URL(node.url); u.hash = ''; set.add(u.href);\r\n        } catch {\r\n          set.add((node.url || '').split('#')[0]);\r\n        }\r\n      }\r\n      if (node.children) stack.push(...node.children);\r\n    }\r\n    state.bookmarkedUrlsSet = set;\r\n    return set;\r\n  } catch (e) {\r\n    state.bookmarkedUrlsSet = new Set();\r\n    return state.bookmarkedUrlsSet;\r\n  }\r\n}\r\n\r\n// \u83B7\u53D6\u4E66\u7B7E\u76F4\u63A5\u4E0A\u7EA7\u6587\u4EF6\u5939\u540D\u79F0\r\nexport async function getBookmarkFolderPath(parentId) {\r\n  if (!parentId) return null;\r\n\r\n  try {\r\n    const folders = await chrome.bookmarks.get(parentId);\r\n    if (!folders || folders.length === 0) return null;\r\n\r\n    const folder = folders[0];\r\n\r\n    // \u8DF3\u8FC7\u6839\u6587\u4EF6\u5939\uFF08\"\u4E66\u7B7E\u680F\"\u3001\"\u5176\u4ED6\u4E66\u7B7E\"\u7B49\uFF09\uFF0C\u8FD4\u56DEnull\r\n    if (!folder.title || !folder.parentId) {\r\n      return null;\r\n    }\r\n\r\n    return folder.title;\r\n  } catch (error) {\r\n    console.log('Error getting bookmark folder path:', error.message);\r\n    return null;\r\n  }\r\n}\r\n\r\n// \u83B7\u53D6\u4E66\u7B7E\u4FE1\u606F\uFF08\u5305\u542B\u72B6\u6001\u3001\u6807\u9898\u548C\u6587\u4EF6\u5939\u8DEF\u5F84\uFF09\r\nexport async function getBookmarkInfo(url, isCurrentTab = false) {\r\n  if (!url) return { isBookmarked: false, title: null, folderPath: null };\r\n\r\n  // \u5F53\u524D\u9875\u9762\u4E0D\u67E5\u7F13\u5B58\uFF0C\u76F4\u63A5\u67E5\u8BE2\r\n  if (isCurrentTab) {\r\n    try {\r\n      const bookmarks = await chrome.bookmarks.search({ url: url });\r\n      const isBookmarked = bookmarks && bookmarks.length > 0;\r\n      let bookmarkTitle = null;\r\n      let folderPath = null;\r\n\r\n      if (isBookmarked) {\r\n        const bookmark = bookmarks[0];\r\n        bookmarkTitle = bookmark.title;\r\n        folderPath = await getBookmarkFolderPath(bookmark.parentId);\r\n      }\r\n\r\n      const bookmarkInfo = { isBookmarked, title: bookmarkTitle, folderPath };\r\n      state.bookmarkCache.set(url, bookmarkInfo);\r\n\r\n      return bookmarkInfo;\r\n    } catch (error) {\r\n      console.log('Error searching bookmarks:', error.message);\r\n      return { isBookmarked: false, title: null, folderPath: null };\r\n    }\r\n  }\r\n\r\n  // \u5176\u4ED6\u9875\u9762\u5148\u67E5\u7F13\u5B58\r\n  if (state.bookmarkCache.has(url)) {\r\n    const cachedInfo = state.bookmarkCache.get(url);\r\n    // \u517C\u5BB9\u65E7\u683C\u5F0F\u7F13\u5B58\uFF08boolean\uFF09\u548C\u65B0\u683C\u5F0F\u7F13\u5B58\uFF08object\uFF09\r\n    if (typeof cachedInfo === 'boolean') {\r\n      return { isBookmarked: cachedInfo, title: null, folderPath: null };\r\n    } else {\r\n      return {\r\n        isBookmarked: cachedInfo.isBookmarked || false,\r\n        title: cachedInfo.title || null,\r\n        folderPath: cachedInfo.folderPath || null\r\n      };\r\n    }\r\n  }\r\n\r\n  // \u7F13\u5B58\u672A\u547D\u4E2D\uFF0C\u67E5\u8BE2API\u5E76\u7F13\u5B58\u7ED3\u679C\r\n  try {\r\n    const bookmarks = await chrome.bookmarks.search({ url: url });\r\n    const isBookmarked = bookmarks && bookmarks.length > 0;\r\n    let bookmarkTitle = null;\r\n    let folderPath = null;\r\n\r\n    if (isBookmarked) {\r\n      const bookmark = bookmarks[0];\r\n      bookmarkTitle = bookmark.title;\r\n      folderPath = await getBookmarkFolderPath(bookmark.parentId);\r\n    }\r\n\r\n    const bookmarkInfo = { isBookmarked, title: bookmarkTitle, folderPath };\r\n    state.bookmarkCache.set(url, bookmarkInfo);\r\n\r\n    return bookmarkInfo;\r\n  } catch (error) {\r\n    console.log('Error searching bookmarks:', error.message);\r\n    const errorInfo = { isBookmarked: false, title: null, folderPath: null };\r\n    state.bookmarkCache.set(url, errorInfo);\r\n    return errorInfo;\r\n  }\r\n}\r\n", "// ===================\r\n// \u591A\u9009\u4E0E\u6EDA\u52A8\u903B\u8F91\r\n// ===================\r\nimport { state } from './state.js';\r\n\r\n// \u9009\u4E2D\u8282\u70B9\u53CA\u5176\u6240\u6709\u5B50\u8282\u70B9\r\nexport function selectNodeAndChildren(node, nodeElement) {\r\n  const isSelected = state.selectedTabIds.has(node.id);\r\n\r\n  if (isSelected) {\r\n    deselectNodeAndChildren(node);\r\n  } else {\r\n    selectNodeAndChildrenRecursive(node);\r\n  }\r\n\r\n  updateSelectionUI();\r\n}\r\n\r\nfunction selectNodeAndChildrenRecursive(node) {\r\n  state.selectedTabIds.add(node.id);\r\n  node.children.forEach(child => {\r\n    selectNodeAndChildrenRecursive(child);\r\n  });\r\n}\r\n\r\nfunction deselectNodeAndChildren(node) {\r\n  state.selectedTabIds.delete(node.id);\r\n  node.children.forEach(child => {\r\n    deselectNodeAndChildren(child);\r\n  });\r\n}\r\n\r\n// \u66F4\u65B0\u9009\u4E2D\u72B6\u6001\u7684UI\u663E\u793A\r\nexport function updateSelectionUI() {\r\n  document.querySelectorAll('.tree-node').forEach(nodeElement => {\r\n    const tabId = parseInt(nodeElement.dataset.tabId);\r\n    if (state.selectedTabIds.has(tabId)) {\r\n      nodeElement.classList.add('selected');\r\n    } else {\r\n      nodeElement.classList.remove('selected');\r\n    }\r\n  });\r\n}\r\n\r\n// \u6EDA\u52A8\u5230\u5F53\u524D\u6807\u7B7E\u9875\r\nexport function scrollToCurrentTab() {\r\n  if (!state.currentTabId) return;\r\n\r\n  const currentNode = document.querySelector(`[data-tab-id=\"${state.currentTabId}\"]`);\r\n  if (currentNode) {\r\n    const container = document.getElementById('treeContainer');\r\n\r\n    const nodeTop = currentNode.offsetTop - currentNode.parentElement.offsetTop;\r\n    const containerHeight = container.clientHeight;\r\n    const nodeHeight = currentNode.offsetHeight;\r\n\r\n    if (nodeTop < container.scrollTop || nodeTop + nodeHeight > container.scrollTop + containerHeight) {\r\n      const targetScrollTop = nodeTop - (containerHeight / 2) + (nodeHeight / 2);\r\n      container.scrollTop = Math.max(0, targetScrollTop);\r\n    }\r\n  }\r\n}\r\n", "// ===================\r\n// \u6807\u7B7E\u9875\u6FC0\u6D3B\u4E0E\u5173\u95ED\u64CD\u4F5C\r\n// ===================\r\nimport { state } from './state.js';\r\n\r\n// \u6FC0\u6D3B\u6807\u7B7E\u9875\u5E76\u5207\u6362\u5230\u5BF9\u5E94\u7A97\u53E3\r\nexport function activateTabAndWindow(tabId) {\r\n  console.log(`Attempting to activate tab ${tabId}`);\r\n\r\n  // \u7ACB\u5373\u6FC0\u6D3B\u6807\u7B7E\u9875\uFF08\u4F18\u5148\u7EA7\u6700\u9AD8\uFF0C\u5FEB\u901F\u54CD\u5E94\uFF09\r\n  chrome.tabs.update(tabId, { active: true }, () => {\r\n    if (chrome.runtime.lastError) {\r\n      console.error('Error activating tab:', chrome.runtime.lastError);\r\n      return;\r\n    }\r\n\r\n    console.log(`Tab ${tabId} activated`);\r\n\r\n    // \u83B7\u53D6\u76EE\u6807\u6807\u7B7E\u9875\u4FE1\u606F\u6765\u68C0\u67E5\u662F\u5426\u9700\u8981\u6FC0\u6D3B\u7A97\u53E3\r\n    chrome.tabs.get(tabId, (targetTab) => {\r\n      if (chrome.runtime.lastError) {\r\n        console.error('Error getting target tab:', chrome.runtime.lastError);\r\n        window.close();\r\n        return;\r\n      }\r\n\r\n      // \u83B7\u53D6\u5F53\u524D\u7A97\u53E3\u4FE1\u606F\r\n      chrome.tabs.query({ active: true, currentWindow: true }, (currentTabs) => {\r\n        if (chrome.runtime.lastError || !currentTabs[0]) {\r\n          console.log('Could not get current window info, activating target window');\r\n          // \u5982\u679C\u83B7\u53D6\u5F53\u524D\u7A97\u53E3\u5931\u8D25\uFF0C\u76F4\u63A5\u6FC0\u6D3B\u76EE\u6807\u7A97\u53E3\uFF08\u5B89\u5168\u7B56\u7565\uFF09\r\n          chrome.windows.update(targetTab.windowId, { focused: true }, () => {\r\n            console.log(`Window ${targetTab.windowId} focused`);\r\n            window.close();\r\n          });\r\n          return;\r\n        }\r\n\r\n        const currentTab = currentTabs[0];\r\n        const needWindowSwitch = targetTab.windowId !== currentTab.windowId;\r\n\r\n        if (needWindowSwitch) {\r\n          console.log(`Focusing window ${targetTab.windowId}`);\r\n          chrome.windows.update(targetTab.windowId, { focused: true }, () => {\r\n            if (chrome.runtime.lastError) {\r\n              console.error('Error focusing window:', chrome.runtime.lastError);\r\n            } else {\r\n              console.log(`Window ${targetTab.windowId} focused`);\r\n            }\r\n            window.close();\r\n          });\r\n        } else {\r\n          console.log('Same window, no need to switch');\r\n          window.close();\r\n        }\r\n      });\r\n    });\r\n  });\r\n}\r\n\r\n// \u4ECEDOM\u4E2D\u79FB\u9664\u6307\u5B9A\u7684\u6807\u7B7E\u9875\u5143\u7D20\r\nexport async function removeTabElements(tabIds) {\r\n  tabIds.forEach(tabId => {\r\n    const element = document.querySelector(`[data-tab-id=\"${tabId}\"]`);\r\n    if (element) {\r\n      element.remove();\r\n    }\r\n  });\r\n\r\n  // \u540C\u65F6\u4ECE\u5386\u53F2\u8BB0\u5F55\u4E2D\u79FB\u9664\u5DF2\u5173\u95ED\u7684\u6807\u7B7E\u9875\r\n  if (window.tabHistory) {\r\n    await window.tabHistory.removeTabsFromHistory(tabIds);\r\n  }\r\n}\r\n\r\n// \u5173\u95ED\u9009\u4E2D\u7684\u6807\u7B7E\u9875\u6216\u5F53\u524D\u8282\u70B9\u53CA\u5176\u5B50\u8282\u70B9\r\nexport async function closeSelectedOrCurrent(node) {\r\n  let tabsToClose = [];\r\n\r\n  if (state.selectedTabIds.size > 0) {\r\n    // \u5982\u679C\u6709\u9009\u4E2D\u7684\u6807\u7B7E\u9875\uFF0C\u5173\u95ED\u6240\u6709\u9009\u4E2D\u7684\u6807\u7B7E\u9875\r\n    tabsToClose = Array.from(state.selectedTabIds);\r\n    // \u6E05\u7A7A\u9009\u4E2D\u72B6\u6001\r\n    state.selectedTabIds.clear();\r\n  } else {\r\n    // \u5982\u679C\u6CA1\u6709\u9009\u4E2D\u7684\u6807\u7B7E\u9875\uFF0C\u5173\u95ED\u5F53\u524D\u8282\u70B9\u53CA\u5176\u5B50\u8282\u70B9\r\n    function collectTabIds(node) {\r\n      tabsToClose.push(node.id);\r\n      node.children.forEach(child => {\r\n        collectTabIds(child);\r\n      });\r\n    }\r\n    collectTabIds(node);\r\n  }\r\n\r\n  // \u901A\u77E5\u540E\u53F0\u811A\u672C\u8FD9\u4E9B\u6807\u7B7E\u9875\u662F\u901A\u8FC7\u63D2\u4EF6\u5173\u95ED\u7684\r\n  try {\r\n    await chrome.runtime.sendMessage({\r\n      action: 'markPluginClosed',\r\n      tabIds: tabsToClose\r\n    });\r\n  } catch (error) {\r\n    console.error('Error notifying plugin close:', error);\r\n  }\r\n\r\n  // \u5173\u95ED\u6807\u7B7E\u9875\r\n  try {\r\n    await chrome.tabs.remove(tabsToClose);\r\n    // \u4ECEDOM\u4E2D\u79FB\u9664\u5DF2\u5173\u95ED\u7684\u6807\u7B7E\u9875\u5143\u7D20\uFF0C\u907F\u514D\u5237\u65B0\u89C6\u56FE\r\n    await removeTabElements(tabsToClose);\r\n  } catch (error) {\r\n    console.warn('Error closing tabs:', error);\r\n  }\r\n}\r\n\r\n// \u5173\u95ED\u6807\u7B7E\u9875\u53CA\u5176\u6240\u6709\u5B50\u8282\u70B9\r\nexport async function closeTabAndChildren(node) {\r\n  const tabsToClose = [];\r\n\r\n  function collectTabIds(node) {\r\n    tabsToClose.push(node.id);\r\n    node.children.forEach(child => {\r\n      collectTabIds(child);\r\n    });\r\n  }\r\n\r\n  collectTabIds(node);\r\n\r\n  // \u901A\u77E5\u540E\u53F0\u811A\u672C\u8FD9\u4E9B\u6807\u7B7E\u9875\u662F\u901A\u8FC7\u63D2\u4EF6\u5173\u95ED\u7684\r\n  try {\r\n    await chrome.runtime.sendMessage({\r\n      action: 'markPluginClosed',\r\n      tabIds: tabsToClose\r\n    });\r\n  } catch (error) {\r\n    console.error('Error notifying plugin close:', error);\r\n  }\r\n\r\n  // \u5173\u95ED\u6807\u7B7E\u9875\r\n  try {\r\n    await chrome.tabs.remove(tabsToClose);\r\n    await removeTabElements(tabsToClose);\r\n  } catch (error) {\r\n    console.error('Error closing tabs:', error);\r\n  }\r\n}\r\n", "// ===================\r\n// \u6811\u52A0\u8F7D\u3001\u6784\u5EFA\u4E0E\u6E32\u67D3\r\n// ===================\r\nimport { state } from './state.js';\r\nimport { scheduleFaviconHydrate, applyIconBackground } from './favicon-ui.js';\r\nimport { detectFileType, getFileTypeConfig } from './file-types.js';\r\nimport { getBookmarkInfo } from './bookmarks.js';\r\nimport { selectNodeAndChildren } from './selection.js';\r\nimport { closeSelectedOrCurrent } from './tab-actions.js';\r\n\r\n// \u7531 popup-main.js \u6CE8\u518C\uFF0C\u907F\u514D tree.js \u53CD\u5411\u4F9D\u8D56 search.js\r\nlet _saveSearchHistory = async (_term) => {};\r\nexport function registerSearchHistorySaver(fn) {\r\n  _saveSearchHistory = fn;\r\n}\r\n\r\n// \u66F4\u65B0\u5BFC\u822A\u6309\u94AE\u72B6\u6001\uFF08\u5355\u6B21 getHistoryData \u8C03\u7528\uFF0C\u907F\u514D\u591A\u6B21\u540E\u53F0\u901A\u4FE1\uFF09\r\nexport async function updateNavigationButtons() {\r\n  if (!window.tabHistory) return;\r\n  const backBtn = document.getElementById('backBtn');\r\n  const forwardBtn = document.getElementById('forwardBtn');\r\n  if (!backBtn && !forwardBtn) return;\r\n\r\n  const data = await window.tabHistory.getHistoryData();\r\n  if (backBtn) backBtn.disabled = data.currentIndex <= 0;\r\n  if (forwardBtn) forwardBtn.disabled = data.currentIndex >= data.history.length - 1;\r\n\r\n  console.log('\uD83D\uDCDA Navigation status:', {\r\n    history: data.history,\r\n    currentIndex: data.currentIndex,\r\n    canGoBack: data.currentIndex > 0,\r\n    canGoForward: data.currentIndex < data.history.length - 1,\r\n  });\r\n}\r\n\r\n// \u6839\u636E\u8FC7\u6EE4\u7ED3\u679C\u66F4\u65B0\u5206\u9694\u7B26\u53EF\u89C1\u6027\r\nexport function updateSeparatorVisibility() {\r\n  const container = document.getElementById('treeContainer');\r\n  if (!container) return;\r\n  const separators = Array.from(container.querySelectorAll('.pinned-separator'));\r\n  const hasAnyGroupHeader = !!container.querySelector('.pinned-separator[data-separator-type=\"group-header\"]');\r\n  separators.forEach(sep => {\r\n    const type = sep.dataset.separatorType || '';\r\n    if (type === 'group-tail' && !hasAnyGroupHeader) {\r\n      sep.style.display = 'none';\r\n      return;\r\n    }\r\n    if (type === 'group-header' || type === 'pinned-header' || type === '') {\r\n      const headerGroupId = sep.dataset.groupId || null;\r\n      let sibling = sep.nextElementSibling;\r\n      let hasVisible = false;\r\n      while (sibling) {\r\n        if (sibling.classList && sibling.classList.contains('pinned-separator')) break;\r\n        if (sibling.classList && sibling.classList.contains('tree-node') && !sibling.classList.contains('hidden')) {\r\n          if (type === 'group-header') {\r\n            const nodeGroupId = sibling.dataset && sibling.dataset.groupId;\r\n            if (nodeGroupId === headerGroupId) { hasVisible = true; break; }\r\n          } else {\r\n            hasVisible = true; break;\r\n          }\r\n        }\r\n        sibling = sibling.nextElementSibling;\r\n      }\r\n      sep.style.display = hasVisible ? 'flex' : 'none';\r\n    } else if (type === 'group-tail') {\r\n      const tailGroupId = sep.dataset.groupId || null;\r\n      let sibling = sep.previousElementSibling;\r\n      let hasVisible = false;\r\n      while (sibling) {\r\n        if (sibling.classList && sibling.classList.contains('pinned-separator')) break;\r\n        if (sibling.classList && sibling.classList.contains('tree-node') && !sibling.classList.contains('hidden')) {\r\n          const nodeGroupId = sibling.dataset && sibling.dataset.groupId;\r\n          if (nodeGroupId === tailGroupId) { hasVisible = true; break; }\r\n        }\r\n        sibling = sibling.previousElementSibling;\r\n      }\r\n      sep.style.display = hasVisible ? 'flex' : 'none';\r\n    }\r\n  });\r\n}\r\n\r\n// \u52A8\u6001\u6309\u9700\u52A0\u8F7D\u811A\u672C\uFF08\u53EA\u52A0\u8F7D\u4E00\u6B21\uFF09\r\nexport async function loadScriptOnce(src) {\r\n  return new Promise((resolve, reject) => {\r\n    if (document.querySelector(`script[data-dynamic=\"${src}\"]`)) {\r\n      resolve();\r\n      return;\r\n    }\r\n    const s = document.createElement('script');\r\n    s.src = src;\r\n    s.async = true;\r\n    s.defer = true;\r\n    s.dataset.dynamic = src;\r\n    s.onload = () => resolve();\r\n    s.onerror = (e) => reject(e);\r\n    document.body.appendChild(s);\r\n  });\r\n}\r\n\r\n// \u52A0\u8F7D\u6807\u7B7E\u9875\u6811\u7ED3\u6784\r\nexport async function loadTabTree() {\r\n  console.log('\uD83D\uDD04 loading TabTree...');\r\n  try {\r\n    const now = Date.now();\r\n    if (now - state.lastRestoreTime > state.RESTORE_COOLDOWN) {\r\n      state.lastRestoreTime = now;\r\n      try {\r\n        await chrome.runtime.sendMessage({ action: 'restoreRelations' });\r\n      } catch (error) {\r\n        console.log('Could not trigger restore (background script may be inactive)');\r\n      }\r\n    }\r\n\r\n    // \u8F6E\u8BE2\u83B7\u53D6tabRelations\uFF0C\u76F4\u5230background\u521D\u59CB\u5316\u5B8C\u6210\r\n    let tabRelations = {};\r\n    let attempts = 0;\r\n    const maxAttempts = 10;\r\n\r\n    while (attempts < maxAttempts) {\r\n      try {\r\n        tabRelations = await chrome.runtime.sendMessage({ action: 'getTabRelations' });\r\n\r\n        if (tabRelations !== undefined) {\r\n          console.log(`\uD83C\uDFAF Background ready after ${attempts + 1} attempts, got ${Object.keys(tabRelations).length} relations`);\r\n          break;\r\n        } else {\r\n          if (attempts === 0) {\r\n            try { await chrome.runtime.sendMessage({ action: 'restoreRelations' }); } catch {}\r\n          }\r\n          attempts++;\r\n          if (attempts < maxAttempts) {\r\n            console.log(`\u23F3 Background not ready yet, attempt ${attempts}/${maxAttempts}, retrying in 100ms...`);\r\n            await new Promise(resolve => setTimeout(resolve, 200));\r\n          }\r\n        }\r\n      } catch (error) {\r\n        attempts++;\r\n        console.log(`\u274C Error getting tab relations, attempt ${attempts}/${maxAttempts}:`, error);\r\n        if (attempts < maxAttempts) {\r\n          await new Promise(resolve => setTimeout(resolve, 200));\r\n        }\r\n      }\r\n    }\r\n\r\n    tabRelations = tabRelations || {};\r\n\r\n    if (attempts >= maxAttempts) {\r\n      console.warn('\u26A0\uFE0F Background may not be ready after maximum attempts, proceeding with empty relations');\r\n    }\r\n\r\n    console.log('\uD83D\uDD04 getTabRelations gets:', Object.keys(tabRelations).length);\r\n\r\n    // \u4E00\u6B21\u6027\u83B7\u53D6\u6240\u6709\u7F6E\u9876\u6807\u7B7E\u9875\u6570\u636E\r\n    try {\r\n      state.pinnedTabsCache = await chrome.runtime.sendMessage({ action: 'getPinnedTabIdsCache' }) || {};\r\n      console.log('\uD83D\uDCCC Loaded pinned tabs cache:', Object.keys(state.pinnedTabsCache).length);\r\n    } catch (error) {\r\n      console.log('Could not load pinned tabs cache:', error);\r\n      state.pinnedTabsCache = {};\r\n    }\r\n\r\n    // \u83B7\u53D6\u5F53\u524D\u6240\u6709\u6807\u7B7E\u9875\r\n    const tabs = await chrome.tabs.query({});\r\n\r\n    // \u9884\u53D6\u5206\u7EC4\u4FE1\u606F\r\n    state.tabGroupInfo = {};\r\n    const enableGroups = await chrome.runtime.sendMessage({ action: 'isFeatureEnabled', feature: 'showTabGroups' }).catch(() => false);\r\n    if (enableGroups && chrome.tabGroups && typeof chrome.tabGroups.get === 'function') {\r\n      try {\r\n        const groupIds = Array.from(new Set((tabs || []).map(t => t.groupId).filter(id => typeof id === 'number' && id >= 0)));\r\n        for (const gid of groupIds) {\r\n          try {\r\n            const info = await chrome.tabGroups.get(gid);\r\n            state.tabGroupInfo[gid] = info || {};\r\n          } catch (e) {\r\n            state.tabGroupInfo[gid] = {};\r\n          }\r\n        }\r\n      } catch (e) {\r\n        state.tabGroupInfo = {};\r\n      }\r\n    }\r\n\r\n    // \u6784\u5EFA\u6811\u7ED3\u6784\r\n    const tree = buildTabTree(tabs, tabRelations);\r\n\r\n    // \u6E32\u67D3\u6811\r\n    renderTree(tree);\r\n    // \u6E32\u67D3\u5B8C\u6210\u540E\u518D\u8865\u56FE\u6807\uFF08\u5F02\u6B65\uFF0C\u4E0D\u963B\u585E\uFF09\r\n    scheduleFaviconHydrate();\r\n\r\n  } catch (error) {\r\n    console.error('Error loading tab tree:', error);\r\n  }\r\n}\r\n\r\n// \u6784\u5EFA\u6807\u7B7E\u9875\u6811\u7ED3\u6784\r\nexport function buildTabTree(tabs, tabRelations) {\r\n  const tabMap = new Map();\r\n  const pinnedTabs = [];\r\n  const normalTabs = [];\r\n\r\n  // \u5982\u679C\u542F\u7528\"\u6700\u8FD1\"\u7B5B\u9009\uFF1A\r\n  if (state.selectedFilters && state.selectedFilters.recent) {\r\n    const hasGroupInfo = state.tabGroupInfo && Object.keys(state.tabGroupInfo).length > 0;\r\n    if (!hasGroupInfo) {\r\n      tabs = tabs.sort((a, b) => (b.lastAccessed || 0) - (a.lastAccessed || 0));\r\n      // \u6709\u641C\u7D22\u8BCD\u65F6\u5168\u91CF\u641C\u7D22\uFF08\u4E0D\u622A\u65AD\uFF09\uFF0C\u65E0\u641C\u7D22\u8BCD\u65F6\u624D\u622A\u53D6\u6700\u8FD130\u6761\r\n      const hasSearch = !!(state.currentSearchTerm || state.selectedFilters.historyTerm);\r\n      if (!hasSearch) {\r\n        tabs = tabs.slice(0, 30);\r\n      }\r\n    }\r\n  }\r\n\r\n  // \u521B\u5EFA\u6807\u7B7E\u9875\u6620\u5C04\r\n  tabs.forEach(tab => {\r\n    tabMap.set(tab.id, {\r\n      ...tab,\r\n      children: []\r\n    });\r\n  });\r\n\r\n  // \u6784\u5EFA\u7236\u5B50\u5173\u7CFB\r\n  tabs.forEach(tab => {\r\n    const parentId = tabRelations[tab.id];\r\n    if (parentId && tabMap.has(parentId)) {\r\n      const parent = tabMap.get(parentId);\r\n      const child = tabMap.get(tab.id);\r\n      parent.children.push(child);\r\n    } else {\r\n      const tabNode = tabMap.get(tab.id);\r\n      const isPinned = state.pinnedTabsCache && state.pinnedTabsCache[tab.id];\r\n      if (isPinned) {\r\n        pinnedTabs.push(tabNode);\r\n      } else {\r\n        normalTabs.push(tabNode);\r\n      }\r\n    }\r\n  });\r\n\r\n  // \u6392\u5E8F\u903B\u8F91\r\n  if (!state.selectedFilters || !state.selectedFilters.recent) {\r\n    pinnedTabs.sort((a, b) => {\r\n      const aTimestamp = state.pinnedTabsCache[a.id]?.timestamp || 0;\r\n      const bTimestamp = state.pinnedTabsCache[b.id]?.timestamp || 0;\r\n      return bTimestamp - aTimestamp;\r\n    });\r\n    normalTabs.sort((a, b) => {\r\n      if (a.windowId !== b.windowId) return a.windowId - b.windowId;\r\n      return a.index - b.index;\r\n    });\r\n  } else {\r\n    const hasGroupInfo = state.tabGroupInfo && Object.keys(state.tabGroupInfo).length > 0;\r\n    if (hasGroupInfo) {\r\n      normalTabs.sort((a, b) => {\r\n        const aGroup = (typeof a.groupId === 'number' && a.groupId >= 0) ? a.groupId : Number.MAX_SAFE_INTEGER;\r\n        const bGroup = (typeof b.groupId === 'number' && b.groupId >= 0) ? b.groupId : Number.MAX_SAFE_INTEGER;\r\n        if (aGroup !== bGroup) return aGroup - bGroup;\r\n        const aTime = a.lastAccessed || 0;\r\n        const bTime = b.lastAccessed || 0;\r\n        return bTime - aTime;\r\n      });\r\n    } else {\r\n      normalTabs.sort((a, b) => (b.lastAccessed || 0) - (a.lastAccessed || 0));\r\n    }\r\n  }\r\n\r\n  return [...pinnedTabs, ...normalTabs];\r\n}\r\n\r\n// \u6E32\u67D3\u6811\u7ED3\u6784\r\nexport function renderTree(tree) {\r\n  const container = document.getElementById('treeContainer');\r\n  container.innerHTML = '';\r\n\r\n  let pinnedTabs = tree.filter(node => state.pinnedTabsCache && state.pinnedTabsCache[node.id]);\r\n  let normalTabs = tree.filter(node => !state.pinnedTabsCache || !state.pinnedTabsCache[node.id]);\r\n\r\n  // \u7F6E\u9876\u6807\u9898\u5206\u9694\u7B26\r\n  if (pinnedTabs.length > 0) {\r\n    const header = document.createElement('div');\r\n    header.className = 'pinned-separator';\r\n    header.dataset.separatorType = 'pinned-header';\r\n    const label = document.createElement('span');\r\n    label.className = 'separator-label';\r\n    label.textContent = i18n('pinnedTabs') || '\uD83D\uDCCC';\r\n    const line = document.createElement('div');\r\n    line.className = 'separator-line';\r\n    header.appendChild(label);\r\n    header.appendChild(line);\r\n    container.appendChild(header);\r\n  }\r\n\r\n  // \u6E32\u67D3\u7F6E\u9876\u6807\u7B7E\u9875\r\n  pinnedTabs.forEach((node) => {\r\n    node.groupId = -1;\r\n    renderNode(node, container, 0, [], false);\r\n  });\r\n\r\n  // \u6E32\u67D3\u666E\u901A\u6807\u7B7E\u9875\uFF08\u5728\u7EC4\u524D\u63D2\u5165\u5206\u9694\u7B26\u4E0E\u7EC4\u540D\uFF09\r\n  const hasGroupInfo = state.tabGroupInfo && Object.keys(state.tabGroupInfo).length > 0;\r\n  let prevGroupId = null;\r\n  let prevWindowId = null;\r\n  normalTabs.forEach((node, index, array) => {\r\n    const currGroupId = (typeof node.groupId === 'number') ? node.groupId : -1;\r\n    const currWindowId = node.windowId;\r\n    const currIsGrouped = currGroupId !== -1;\r\n\r\n    const windowChanged = index > 0 && currWindowId !== prevWindowId;\r\n    const groupChanged = index === 0 ? false : (windowChanged || currGroupId !== prevGroupId);\r\n\r\n    if (hasGroupInfo && currIsGrouped && ((index === 0) || groupChanged)) {\r\n      const header = document.createElement('div');\r\n      header.className = 'pinned-separator';\r\n      header.dataset.separatorType = 'group-header';\r\n      header.dataset.groupId = String(currGroupId);\r\n\r\n      const label = document.createElement('span');\r\n      label.className = 'separator-label';\r\n      const title = (state.tabGroupInfo[currGroupId] && state.tabGroupInfo[currGroupId].title) ? state.tabGroupInfo[currGroupId].title : (i18n('tabGroup') || 'Group');\r\n      label.textContent = title;\r\n\r\n      const line = document.createElement('div');\r\n      line.className = 'separator-line';\r\n\r\n      header.appendChild(label);\r\n      header.appendChild(line);\r\n      container.appendChild(header);\r\n    }\r\n\r\n    renderNode(node, container, 0, [], index === array.length - 1);\r\n\r\n    prevGroupId = currGroupId;\r\n    prevWindowId = currWindowId;\r\n  });\r\n\r\n  // \u5217\u8868\u672B\u5C3E\u82E5\u6700\u540E\u4E00\u4E2A\u662F\"\u5206\u7EC4\"\uFF0C\u8865\u4E00\u4E2A\u5C3E\u90E8\u5206\u9694\u7B26\r\n  if (hasGroupInfo && normalTabs.length > 0) {\r\n    const lastNode = normalTabs[normalTabs.length - 1];\r\n    const lastGroupId = (typeof lastNode.groupId === 'number') ? lastNode.groupId : -1;\r\n    if (lastGroupId !== -1) {\r\n      const tail = document.createElement('div');\r\n      tail.className = 'pinned-separator';\r\n      tail.dataset.separatorType = 'group-tail';\r\n      tail.dataset.groupId = String(lastGroupId);\r\n      const tailLine = document.createElement('div');\r\n      tailLine.className = 'separator-line';\r\n      tail.appendChild(tailLine);\r\n      container.appendChild(tail);\r\n    }\r\n  }\r\n\r\n  // \u6E32\u67D3\u5B8C\u6210\u540E\u66F4\u65B0\u4E00\u6B21\u5206\u9694\u7B26\u53EF\u89C1\u6027\r\n  updateSeparatorVisibility();\r\n  // \u6E32\u67D3\u5B8C\u6210\u540E\u518D\u5F02\u6B65\u8865\u56FE\u6807\r\n  scheduleFaviconHydrate();\r\n}\r\n\r\n// \u6E32\u67D3\u5355\u4E2A\u8282\u70B9\r\nexport function renderNode(node, container, depth, parentLines = [], isLast = false) {\r\n  const nodeElement = document.createElement('div');\r\n  nodeElement.className = 'tree-node';\r\n  nodeElement.dataset.tabId = node.id;\r\n  nodeElement.dataset.tabUrl = node.url || '';\r\n  nodeElement.dataset.favIconUrl = node.favIconUrl || '';\r\n  nodeElement.dataset.groupId = (typeof node.groupId === 'number' && node.groupId >= 0) ? String(node.groupId) : '-1';\r\n\r\n  if (node.id === state.currentTabId) {\r\n    nodeElement.classList.add('current-tab');\r\n  }\r\n\r\n  if (node.discarded || node.status === 'unloaded') {\r\n    nodeElement.classList.add('unloaded');\r\n  }\r\n\r\n  const isPinned = state.pinnedTabsCache && state.pinnedTabsCache[node.id];\r\n  if (isPinned) {\r\n    nodeElement.classList.add('pinned-tab');\r\n    console.log('\uD83D\uDCCC Applied pinned styling to tab:', node.id, node.title);\r\n  }\r\n\r\n  // \u56FE\u6807\r\n  const icon = document.createElement('div');\r\n  icon.className = 'tree-icon';\r\n  icon.dataset.faviconSource = 'init';\r\n  icon.classList.add('icon-placeholder');\r\n\r\n  const fileType = detectFileType(node.url);\r\n  if (fileType) {\r\n    const config = getFileTypeConfig(fileType);\r\n    if (config) {\r\n      const iconUrl = chrome.runtime.getURL(config.icon);\r\n      applyIconBackground(icon, iconUrl, 'filetype', config.bgColor || 'transparent');\r\n      icon.style.backgroundSize = 'contain';\r\n      icon.style.backgroundRepeat = 'no-repeat';\r\n      icon.style.backgroundPosition = 'center';\r\n      icon.style.width = '16px';\r\n      icon.style.height = '16px';\r\n      icon.innerHTML = '';\r\n      icon.title = i18n(config.title);\r\n    }\r\n    icon.dataset.faviconSource = 'filetype';\r\n  } else {\r\n    icon.style.backgroundImage = '';\r\n    icon.style.backgroundColor = '';\r\n    icon.dataset.faviconSource = 'pending';\r\n  }\r\n\r\n  // \u56FE\u5F62\u5316\u6811\u5F62\u7ED3\u6784 gutter\r\n  const gutter = document.createElement('div');\r\n  gutter.className = 'tree-gutter';\r\n  gutter.style.setProperty('--depth', String(depth));\r\n\r\n  for (let i = 0; i < Math.max(0, depth - 1); i++) {\r\n    const col = document.createElement('div');\r\n    col.className = 'tree-col';\r\n    if (i < parentLines.length && parentLines[i]) {\r\n      col.classList.add('has-line');\r\n    }\r\n    gutter.appendChild(col);\r\n  }\r\n\r\n  if (depth > 0) {\r\n    const junction = document.createElement('div');\r\n    junction.className = 'tree-col tree-junction';\r\n    junction.classList.add(isLast ? 'is-last' : 'is-tee');\r\n    gutter.appendChild(junction);\r\n  }\r\n\r\n  const iconCol = document.createElement('div');\r\n  iconCol.className = 'tree-col tree-icon-col';\r\n  iconCol.appendChild(icon);\r\n  gutter.appendChild(iconCol);\r\n\r\n  nodeElement.appendChild(gutter);\r\n\r\n  // \u6807\u9898\r\n  const title = document.createElement('div');\r\n  title.className = 'tree-title';\r\n  title.textContent = node.title || node.url;\r\n  title.title = `${node.title}\\n\\n${node.url}`;\r\n  nodeElement.appendChild(title);\r\n\r\n  // \u72B6\u6001\u663E\u793A\u5BB9\u5668\r\n  const statusContainer = document.createElement('div');\r\n  statusContainer.className = 'tab-status-container';\r\n\r\n  if (node.audible) {\r\n    const audioStatus = document.createElement('span');\r\n    audioStatus.textContent = '\u266A';\r\n    audioStatus.className = 'tab-status playing';\r\n    audioStatus.title = i18n('audioPlaying');\r\n    statusContainer.appendChild(audioStatus);\r\n  } else if (node.mutedInfo && node.mutedInfo.muted) {\r\n    const mutedStatus = document.createElement('span');\r\n    mutedStatus.textContent = '\u00D7';\r\n    mutedStatus.className = 'tab-status muted';\r\n    mutedStatus.title = i18n('audioMuted');\r\n    statusContainer.appendChild(mutedStatus);\r\n  }\r\n\r\n  // \u5F02\u6B65\u83B7\u53D6\u4E66\u7B7E\u4FE1\u606F\r\n  const isCurrentTab = node.id === state.currentTabId;\r\n  getBookmarkInfo(node.url, isCurrentTab).then(bookmarkInfo => {\r\n    let tooltipText = `${node.title}`;\r\n\r\n    if (bookmarkInfo.isBookmarked && bookmarkInfo.title && bookmarkInfo.title.trim()) {\r\n      title.textContent = bookmarkInfo.title;\r\n\r\n      if (node.title === bookmarkInfo.title) {\r\n        tooltipText = `\uD83D\uDCC4 ${i18n('tooltipTitleLabel')}: ${node.title}`;\r\n      } else {\r\n        tooltipText = `\uD83D\uDCC4 ${i18n('tooltipTitleLabel')}: ${node.title}\\n\uD83D\uDCD6 ${i18n('tooltipBookmarkLabel')}: ${bookmarkInfo.title}`;\r\n      }\r\n    }\r\n\r\n    if (bookmarkInfo.isBookmarked && bookmarkInfo.folderPath) {\r\n      tooltipText += `\\n\uD83D\uDCC1 ${i18n('tooltipFolderLabel')}: ${bookmarkInfo.folderPath}`;\r\n    }\r\n\r\n    title.title = tooltipText + `\\n\\n${node.url}`;\r\n\r\n    if (bookmarkInfo.isBookmarked) {\r\n      const bookmarkStatus = document.createElement('span');\r\n      bookmarkStatus.textContent = '\u2605';\r\n      bookmarkStatus.className = 'tab-status bookmarked';\r\n      bookmarkStatus.title = i18n('bookmarkAdded');\r\n      statusContainer.appendChild(bookmarkStatus);\r\n    }\r\n  }).catch(error => {\r\n    console.log('Error getting bookmark info:', error.message);\r\n  });\r\n\r\n  nodeElement.appendChild(statusContainer);\r\n\r\n  // \u64CD\u4F5C\u533A\u57DF\u5BB9\u5668\r\n  const actionsContainer = document.createElement('div');\r\n  actionsContainer.className = 'tree-actions';\r\n\r\n  // \u9009\u62E9\u6309\u94AE\u5BB9\u5668\r\n  const selectBtnContainer = document.createElement('div');\r\n  selectBtnContainer.className = 'select-btn-container';\r\n\r\n  const selectBtn = document.createElement('button');\r\n  selectBtn.className = 'select-btn';\r\n  selectBtn.textContent = '\u2713';\r\n  selectBtn.title = i18n('selectNode');\r\n\r\n  const selectOverlay = document.createElement('div');\r\n  selectOverlay.className = 'select-btn-overlay';\r\n  selectOverlay.addEventListener('click', (e) => {\r\n    e.stopPropagation();\r\n    selectNodeAndChildren(node, nodeElement);\r\n  });\r\n\r\n  selectBtnContainer.appendChild(selectBtn);\r\n  selectBtnContainer.appendChild(selectOverlay);\r\n\r\n  // \u7F6E\u9876\u6309\u94AE\u5BB9\u5668\r\n  const pinBtnContainer = document.createElement('div');\r\n  pinBtnContainer.className = 'pin-btn-container';\r\n\r\n  const pinBtn = document.createElement('button');\r\n  pinBtn.className = 'pin-btn';\r\n  const pinIcon = document.createElement('span');\r\n  pinIcon.className = 'pin-icon';\r\n\r\n  const isPinnedForButton = state.pinnedTabsCache && state.pinnedTabsCache[node.id];\r\n  if (isPinnedForButton) {\r\n    pinIcon.textContent = '\uD83D\uDCCC';\r\n    pinBtn.title = i18n('unpinFromTop') || 'Unpin from top';\r\n  } else {\r\n    pinIcon.textContent = '\u2B06';\r\n    pinBtn.title = i18n('pinToTop') || 'Pin to top';\r\n  }\r\n\r\n  pinBtn.appendChild(pinIcon);\r\n\r\n  const pinOverlay = document.createElement('div');\r\n  pinOverlay.className = 'pin-btn-overlay';\r\n  pinOverlay.addEventListener('click', async (e) => {\r\n    e.stopPropagation();\r\n    try {\r\n      const isCurrentlyPinned = state.pinnedTabsCache && state.pinnedTabsCache[node.id];\r\n\r\n      if (isCurrentlyPinned) {\r\n        await chrome.runtime.sendMessage({ action: 'removePinnedTab', tabId: node.id });\r\n        delete state.pinnedTabsCache[node.id];\r\n        console.log(`\uD83D\uDCCC Unpinned tab: ${node.id}`);\r\n      } else {\r\n        await chrome.tabs.move(node.id, { index: 0 });\r\n\r\n        try {\r\n          await chrome.runtime.sendMessage({ action: 'removeTabRelationsFor', tabId: node.id });\r\n        } catch (remErr) {\r\n          console.warn('Failed to remove relations for pinned tab:', remErr);\r\n        }\r\n\r\n        const tabInfo = {\r\n          url: node.url,\r\n          title: node.title\r\n        };\r\n        await chrome.runtime.sendMessage({\r\n          action: 'addPinnedTab',\r\n          tabId: node.id,\r\n          tabInfo: tabInfo\r\n        });\r\n\r\n        state.pinnedTabsCache[node.id] = {\r\n          ...tabInfo,\r\n          timestamp: Date.now()\r\n        };\r\n        console.log(`\uD83D\uDCCC Pinned tab: ${node.id} - ${node.title}`);\r\n      }\r\n\r\n      await loadTabTree();\r\n    } catch (err) {\r\n      console.error('Error toggling pin state:', err);\r\n    }\r\n  });\r\n\r\n  pinBtnContainer.appendChild(pinBtn);\r\n  pinBtnContainer.appendChild(pinOverlay);\r\n\r\n  // \u5173\u95ED\u6309\u94AE\u5BB9\u5668\r\n  const closeBtnContainer = document.createElement('div');\r\n  closeBtnContainer.className = 'close-btn-container';\r\n\r\n  const closeBtn = document.createElement('button');\r\n  closeBtn.className = 'close-btn';\r\n  closeBtn.textContent = '\u00D7';\r\n\r\n  const closeOverlay = document.createElement('div');\r\n  closeOverlay.className = 'close-btn-overlay';\r\n  closeOverlay.addEventListener('click', (e) => {\r\n    e.stopPropagation();\r\n    closeSelectedOrCurrent(node);\r\n  });\r\n\r\n  closeOverlay.addEventListener('mouseenter', () => {\r\n    if (state.selectedTabIds.size > 0) {\r\n      closeBtn.title = i18n('closeSelectedTabs', [state.selectedTabIds.size.toString()]);\r\n    } else {\r\n      closeBtn.title = i18n('closeNode');\r\n    }\r\n  });\r\n\r\n  closeBtnContainer.appendChild(closeBtn);\r\n  closeBtnContainer.appendChild(closeOverlay);\r\n\r\n  actionsContainer.appendChild(selectBtnContainer);\r\n  actionsContainer.appendChild(pinBtnContainer);\r\n  actionsContainer.appendChild(closeBtnContainer);\r\n\r\n  nodeElement.appendChild(actionsContainer);\r\n\r\n  // \u70B9\u51FB\u8282\u70B9\u4E8B\u4EF6\r\n  nodeElement.addEventListener('click', async (e) => {\r\n    e.stopPropagation();\r\n    console.log(`Node clicked: ${node.id} - ${node.title}`);\r\n    try {\r\n      const input = document.getElementById('searchInput');\r\n      const term = (input && input.value ? input.value.trim() : '');\r\n      if (term) {\r\n        await _saveSearchHistory(term);\r\n      }\r\n    } catch (_) {}\r\n    // activateTabAndWindow is imported indirectly via popup-main\r\n    activateTabAndWindowFn(node.id);\r\n  });\r\n\r\n  container.appendChild(nodeElement);\r\n\r\n  // \u9012\u5F52\u6E32\u67D3\u5B50\u8282\u70B9\r\n  if (node.children && node.children.length > 0) {\r\n    const newParentLines = [...parentLines];\r\n    if (depth > 0) {\r\n      newParentLines[depth - 1] = !isLast;\r\n    }\r\n\r\n    node.children.forEach((child, index, array) => {\r\n      renderNode(child, container, depth + 1, newParentLines, index === array.length - 1);\r\n    });\r\n  }\r\n}\r\n\r\n// activateTabAndWindow \u7531 popup-main.js \u6CE8\u5165\uFF0C\u907F\u514D\u5FAA\u73AF\u4F9D\u8D56\r\nlet activateTabAndWindowFn = (_tabId) => {};\r\nexport function registerActivateTabFn(fn) {\r\n  activateTabAndWindowFn = fn;\r\n}\r\n", "// ===================\r\n// \u641C\u7D22\u3001\u8FC7\u6EE4\u5668\uFF08chips\uFF09\u4E0E\u641C\u7D22\u5386\u53F2\r\n// ===================\r\nimport { state } from './state.js';\r\nimport { loadTabTree, updateSeparatorVisibility } from './tree.js';\r\nimport { scrollToCurrentTab } from './selection.js';\r\nimport { getAllBookmarkedUrlSet } from './bookmarks.js';\r\n\r\n// --------------------\r\n// \u6700\u8FD1\u6807\u7B7E\u6301\u4E45\u5316\r\n// --------------------\r\nexport async function saveRecentPreference(enabled) {\r\n  try { await chrome.runtime.sendMessage({ action: 'setDefaultRecentFilter', value: !!enabled }); } catch {}\r\n}\r\n\r\nexport async function loadRecentPreference() {\r\n  try {\r\n    const res = await chrome.runtime.sendMessage({ action: 'getDefaultRecentFilter' });\r\n    return !!(res && res.value);\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n// --------------------\r\n// \u641C\u7D22\u5386\u53F2\r\n// --------------------\r\nexport async function loadSearchHistory() {\r\n  try {\r\n    const store = await chrome.storage.local.get('searchHistory');\r\n    state.searchHistory = Array.isArray(store.searchHistory) ? store.searchHistory : [];\r\n  } catch (e) {\r\n    state.searchHistory = [];\r\n  }\r\n}\r\n\r\nexport async function saveSearchHistory(term) {\r\n  const t = (term || '').trim();\r\n  if (!t) return;\r\n  state.searchHistory = [t, ...state.searchHistory.filter(x => x !== t)].slice(0, 10);\r\n  try { await chrome.storage.local.set({ searchHistory: state.searchHistory }); } catch {}\r\n}\r\n\r\n// --------------------\r\n// Chips \u5C42\uFF08\u8F93\u5165\u6846\u5185\u7684\u8FC7\u6EE4\u6807\u7B7E\uFF09\r\n// --------------------\r\nexport function renderChipsLayer() {\r\n  const chipsLayer = document.getElementById('chipsLayer');\r\n  if (!chipsLayer) return;\r\n  chipsLayer.innerHTML = '';\r\n\r\n  const addChip = (label, type) => {\r\n    const chip = document.createElement('span');\r\n    chip.className = 'tag-chip';\r\n    chip.textContent = label + ' ';\r\n    const remove = document.createElement('span');\r\n    remove.className = 'remove';\r\n    remove.textContent = '\u00D7';\r\n    remove.title = 'Remove';\r\n    remove.addEventListener('click', async (e) => {\r\n      e.stopPropagation();\r\n      if (type === 'bookmarked') state.selectedFilters.bookmarked = false;\r\n      if (type === 'recent') {\r\n        state.selectedFilters.recent = false;\r\n        await saveRecentPreference(false);\r\n      }\r\n      if (type === 'history') state.selectedFilters.historyTerm = null;\r\n      renderChipsLayer();\r\n      performSearch(document.getElementById('searchInput')?.value || '');\r\n    });\r\n    chip.appendChild(remove);\r\n    chipsLayer.appendChild(chip);\r\n  };\r\n\r\n  // \u663E\u793A\u987A\u5E8F\uFF1A\u6700\u8FD1 \u2192 \u4E66\u7B7E \u2192 \u5386\u53F2\r\n  if (state.selectedFilters.recent) addChip(i18n('recent2h') || 'Recent', 'recent');\r\n  if (state.selectedFilters.bookmarked) addChip(i18n('bookmarked') || 'Bookmarked', 'bookmarked');\r\n  if (state.selectedFilters.historyTerm) addChip(state.selectedFilters.historyTerm, 'history');\r\n\r\n  const input = document.getElementById('searchInput');\r\n  if (input) {\r\n    const basePadding = 35;\r\n    const gap = 6;\r\n    const chipsWidth = chipsLayer.children.length > 0 ? Math.min(chipsLayer.scrollWidth, (input.clientWidth - basePadding - 30)) : 0;\r\n    const newPadding = chipsWidth > 0 ? (basePadding + chipsWidth + gap) : basePadding;\r\n    input.style.paddingLeft = newPadding + 'px';\r\n  }\r\n}\r\n\r\n// --------------------\r\n// \u6807\u7B7E\u5EFA\u8BAE\uFF08\u641C\u7D22\u6846\u4E0B\u65B9\uFF09\r\n// --------------------\r\nexport function renderTagSuggestions() {\r\n  const container = document.getElementById('tagSuggestions');\r\n  if (!container) return;\r\n  container.innerHTML = '';\r\n\r\n  const makeChip = (text, onClick) => {\r\n    const el = document.createElement('span');\r\n    el.className = 'tag-chip';\r\n    el.textContent = text;\r\n    el.addEventListener('mousedown', async (e) => {\r\n      e.preventDefault();\r\n      await onClick();\r\n    });\r\n    return el;\r\n  };\r\n\r\n  container.appendChild(makeChip(i18n('recent2h') || 'Recent 2h', async () => {\r\n    state.selectedFilters.recent = !state.selectedFilters.recent;\r\n    await saveRecentPreference(state.selectedFilters.recent);\r\n    state.suppressAutoSearchOnce = true;\r\n    renderChipsLayer();\r\n    performSearch(document.getElementById('searchInput')?.value || '');\r\n  }));\r\n\r\n  container.appendChild(makeChip(i18n('bookmarked') || 'Bookmarked', async () => {\r\n    state.selectedFilters.bookmarked = !state.selectedFilters.bookmarked;\r\n    renderChipsLayer();\r\n    performSearch(document.getElementById('searchInput')?.value || '');\r\n  }));\r\n\r\n  // \u52A0\u8F7D\u5386\u53F2\r\n  loadSearchHistory().then(() => {\r\n    (state.searchHistory || []).slice(0, 6).forEach(term => {\r\n      if (!term) return;\r\n      container.appendChild(makeChip(term, () => {\r\n        state.selectedFilters.historyTerm = term;\r\n        const input = document.getElementById('searchInput');\r\n        if (input) input.value = '';\r\n        renderChipsLayer();\r\n        performSearch('');\r\n      }));\r\n    });\r\n  });\r\n  container.style.display = 'flex';\r\n}\r\n\r\n// --------------------\r\n// \u641C\u7D22\u6838\u5FC3\u903B\u8F91\r\n// --------------------\r\n\r\nfunction normalizeText(text) {\r\n  if (!text) return '';\r\n  return text\r\n    .toLowerCase()\r\n    .replace(/[\\uff01-\\uff5e]/g, function(ch) {\r\n      return String.fromCharCode(ch.charCodeAt(0) - 0xfee0);\r\n    })\r\n    .replace(/\\u3000/g, ' ')\r\n    .replace(/\\s+/g, ' ')\r\n    .trim();\r\n}\r\n\r\nfunction escapeRegExp(string) {\r\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n}\r\n\r\nfunction highlightText(element, searchTerm) {\r\n  removeHighlight(element);\r\n\r\n  if (!searchTerm) return;\r\n\r\n  const text = element.textContent;\r\n  const normalizedText = normalizeText(text);\r\n  const normalizedSearchTerm = normalizeText(searchTerm);\r\n  const index = normalizedText.indexOf(normalizedSearchTerm);\r\n\r\n  if (index !== -1) {\r\n    let originalIndex = index;\r\n    let originalLength = normalizedSearchTerm.length;\r\n\r\n    if (normalizedText !== text.toLowerCase()) {\r\n      const pattern = new RegExp(escapeRegExp(searchTerm), 'i');\r\n      const match = text.match(pattern);\r\n      if (match) {\r\n        originalIndex = match.index;\r\n        originalLength = match[0].length;\r\n      }\r\n    }\r\n\r\n    const beforeText = text.substring(0, originalIndex);\r\n    const matchText = text.substring(originalIndex, originalIndex + originalLength);\r\n    const afterText = text.substring(originalIndex + originalLength);\r\n\r\n    element.innerHTML = beforeText +\r\n      '<span class=\"search-highlight\">' + matchText + '</span>' +\r\n      afterText;\r\n  }\r\n}\r\n\r\nfunction removeHighlight(nodeOrElement) {\r\n  const element = nodeOrElement.querySelector ?\r\n    nodeOrElement.querySelector('.tree-title') : nodeOrElement;\r\n\r\n  if (element) {\r\n    const highlights = element.querySelectorAll('.search-highlight');\r\n    highlights.forEach(highlight => {\r\n      const text = highlight.textContent;\r\n      highlight.replaceWith(document.createTextNode(text));\r\n    });\r\n    element.normalize();\r\n  }\r\n}\r\n\r\nfunction showParentNodes(node) {\r\n  let parent = node.parentElement;\r\n  while (parent && parent.classList.contains('tree-node')) {\r\n    parent.classList.remove('hidden');\r\n    parent = parent.parentElement;\r\n  }\r\n}\r\n\r\nfunction showAllNodes() {\r\n  const allNodes = document.querySelectorAll('.tree-node');\r\n  allNodes.forEach(node => {\r\n    node.classList.remove('hidden');\r\n    removeHighlight(node);\r\n  });\r\n\r\n  const separators = document.querySelectorAll('.pinned-separator');\r\n  separators.forEach(sep => sep.style.display = 'flex');\r\n  updateSeparatorVisibility();\r\n}\r\n\r\nfunction showNoResultsMessage() {\r\n  removeNoResultsMessage();\r\n  const treeContainer = document.getElementById('treeContainer');\r\n  const noResults = document.createElement('div');\r\n  noResults.className = 'no-results';\r\n  noResults.id = 'noResults';\r\n  noResults.textContent = `No tabs found matching \"${state.currentSearchTerm}\"`;\r\n  treeContainer.appendChild(noResults);\r\n}\r\n\r\nfunction removeNoResultsMessage() {\r\n  const existing = document.getElementById('noResults');\r\n  if (existing) {\r\n    existing.remove();\r\n  }\r\n}\r\n\r\nasync function filterNodesWithTags() {\r\n  const allNodes = document.querySelectorAll('.tree-node');\r\n  let hasVisibleResults = false;\r\n  let hasPinnedResults = false;\r\n  let hasNormalResults = false;\r\n\r\n  allNodes.forEach((node, index) => {\r\n    const tabTitle = node.querySelector('.tree-title');\r\n    const tabUrl = node.getAttribute('data-tab-url') || '';\r\n    const titleText = tabTitle ? normalizeText(tabTitle.textContent) : '';\r\n    const tabId = parseInt(node.getAttribute('data-tab-id'));\r\n\r\n    const titleMatches = state.currentSearchTerm ? titleText.includes(state.currentSearchTerm) : true;\r\n    const urlMatches = state.currentSearchTerm ? normalizeText(tabUrl).includes(state.currentSearchTerm) : true;\r\n    let matches = titleMatches || urlMatches;\r\n\r\n    if (matches && state.selectedFilters.historyTerm && !state.currentSearchTerm) {\r\n      const hist = normalizeText(state.selectedFilters.historyTerm);\r\n      matches = titleText.includes(hist) || normalizeText(tabUrl).includes(hist);\r\n    }\r\n\r\n    if (matches && state.selectedFilters.bookmarked) {\r\n      const normalize = (u) => { try { const x = new URL(u); x.hash = ''; return x.href; } catch { return (u||'').split('#')[0]; } };\r\n      const norm = normalize(tabUrl);\r\n      if (!state.bookmarkedUrlsSet || !state.bookmarkedUrlsSet.has(norm)) {\r\n        matches = false;\r\n      }\r\n    }\r\n\r\n    if (index < 3 && state.currentSearchTerm) {\r\n      console.log(`\uD83D\uDD0D Node ${index} debug:`, {\r\n        originalTitle: tabTitle ? tabTitle.textContent : 'No title',\r\n        normalizedTitle: titleText,\r\n        searchTerm: state.currentSearchTerm,\r\n        titleMatches,\r\n        urlMatches,\r\n        matches\r\n      });\r\n    }\r\n\r\n    if (matches) {\r\n      node.classList.remove('hidden');\r\n      showParentNodes(node);\r\n      hasVisibleResults = true;\r\n\r\n      const isPinned = state.pinnedTabsCache && state.pinnedTabsCache[tabId];\r\n      if (isPinned) {\r\n        hasPinnedResults = true;\r\n      } else {\r\n        hasNormalResults = true;\r\n      }\r\n\r\n      if (titleMatches && tabTitle) {\r\n        highlightText(tabTitle, state.currentSearchTerm);\r\n      }\r\n    } else {\r\n      node.classList.add('hidden');\r\n    }\r\n  });\r\n\r\n  updateSeparatorVisibility();\r\n\r\n  return hasVisibleResults;\r\n}\r\n\r\nexport async function performSearch(searchTerm) {\r\n  state.currentSearchTerm = normalizeText(searchTerm);\r\n\r\n  console.log('\uD83D\uDD0D Search debug:', {\r\n    original: searchTerm,\r\n    normalized: state.currentSearchTerm,\r\n    length: state.currentSearchTerm.length\r\n  });\r\n\r\n  if ((state.selectedFilters.recent) && !state.isRefreshingByRecent) {\r\n    try {\r\n      state.isRefreshingByRecent = true;\r\n      await loadTabTree();\r\n    } finally {\r\n      state.isRefreshingByRecent = false;\r\n    }\r\n    state.selectedFilters.lastRecent = state.selectedFilters.recent;\r\n  }\r\n\r\n  if (!searchTerm && !state.selectedFilters.bookmarked && !state.selectedFilters.recent && !state.selectedFilters.historyTerm) {\r\n    showAllNodes();\r\n    removeNoResultsMessage();\r\n    scrollToCurrentTab();\r\n    return;\r\n  }\r\n\r\n  if (state.selectedFilters.bookmarked && !state.bookmarkedUrlsSet) {\r\n    await getAllBookmarkedUrlSet();\r\n  }\r\n\r\n  const hasResults = await filterNodesWithTags();\r\n\r\n  if (!hasResults) {\r\n    showNoResultsMessage();\r\n  } else {\r\n    removeNoResultsMessage();\r\n  }\r\n  scrollToCurrentTab();\r\n}\r\n\r\nexport function clearSearch() {\r\n  const searchInput = document.getElementById('searchInput');\r\n  const clearBtn = document.getElementById('clearSearchBtn');\r\n\r\n  if (searchInput) {\r\n    searchInput.value = '';\r\n    searchInput.focus();\r\n  }\r\n\r\n  if (clearBtn) {\r\n    clearBtn.classList.remove('visible');\r\n  }\r\n\r\n  state.currentSearchTerm = '';\r\n  showAllNodes();\r\n  removeNoResultsMessage();\r\n  renderChipsLayer();\r\n}\r\n\r\nexport function initializeSearch() {\r\n  const searchInput = document.getElementById('searchInput');\r\n  const clearSearchBtn = document.getElementById('clearSearchBtn');\r\n\r\n  if (!searchInput || !clearSearchBtn) return;\r\n\r\n  searchInput.addEventListener('input', (e) => {\r\n    const searchTerm = e.target.value.trim();\r\n    const clearBtn = document.getElementById('clearSearchBtn');\r\n    if (searchTerm) {\r\n      clearBtn.classList.add('visible');\r\n    } else {\r\n      clearBtn.classList.remove('visible');\r\n    }\r\n    performSearch(searchTerm);\r\n  });\r\n\r\n  searchInput.addEventListener('keydown', (e) => {\r\n    if (e.key === 'Escape') {\r\n      clearSearch();\r\n    }\r\n  });\r\n\r\n  clearSearchBtn.addEventListener('click', clearSearch);\r\n\r\n  setTimeout(() => {\r\n    searchInput.focus();\r\n  }, 100);\r\n}\r\n", "// ===================\r\n// \u8C03\u8BD5\u5DE5\u5177\r\n// ===================\r\nimport { state } from './state.js';\r\nimport { isPdfUrl } from './file-types.js';\r\nimport { calculateTreeHeight } from './layout.js';\r\nimport { loadTabTree } from './tree.js';\r\n\r\n// ===================\r\n// \u5BFC\u822A\u72B6\u6001\u7BA1\u7406\r\n// ===================\r\nexport const NavigationHelper = {\r\n  async isNavigating() {\r\n    try {\r\n      const historyData = await chrome.runtime.sendMessage({ action: 'getHistoryData' });\r\n      return historyData ? historyData.currentIndex == historyData.history.length - 1 : false;\r\n    } catch (error) {\r\n      console.error('Error getting navigation state:', error);\r\n      return false;\r\n    }\r\n  }\r\n};\r\n\r\n// ===================\r\n// debugSearch \u2014 \u66B4\u9732\u5230 window\r\n// ===================\r\nfunction normalizeText(text) {\r\n  if (!text) return '';\r\n  return text\r\n    .toLowerCase()\r\n    .replace(/[\\uff01-\\uff5e]/g, ch => String.fromCharCode(ch.charCodeAt(0) - 0xfee0))\r\n    .replace(/\\u3000/g, ' ')\r\n    .replace(/\\s+/g, ' ')\r\n    .trim();\r\n}\r\n\r\nexport function installDebugGlobals(performSearch) {\r\n  window.debugSearch = {\r\n    testNormalize: (text) => {\r\n      console.log('\uD83D\uDCDD Text normalization test:', {\r\n        original: text,\r\n        normalized: normalizeText(text)\r\n      });\r\n      return normalizeText(text);\r\n    },\r\n    testSearch: (searchTerm) => {\r\n      console.log('\uD83D\uDD0D Testing search for:', searchTerm);\r\n      performSearch(searchTerm);\r\n    },\r\n    getAllTitles: () => {\r\n      const titles = [];\r\n      document.querySelectorAll('.tree-title').forEach((el, index) => {\r\n        const original = el.textContent;\r\n        const normalized = normalizeText(original);\r\n        titles.push({ index, original, normalized });\r\n      });\r\n      console.table(titles);\r\n      return titles;\r\n    }\r\n  };\r\n\r\n  window.debugPopup = {\r\n    testNormalize: (text) => normalizeText(text),\r\n    testSearch: (term) => performSearch(term),\r\n    getAllTitles: () => {\r\n      const titles = [];\r\n      document.querySelectorAll('.tree-title').forEach(el => {\r\n        titles.push(el.textContent);\r\n      });\r\n      return titles;\r\n    },\r\n    adjustHeight: () => calculateTreeHeight(),\r\n    getHeightInfo: () => {\r\n      const body = document.body;\r\n      const html = document.documentElement;\r\n      const treeContainer = document.getElementById('treeContainer');\r\n      return {\r\n        bodyScrollHeight: body.scrollHeight,\r\n        bodyClientHeight: body.clientHeight,\r\n        htmlScrollHeight: html.scrollHeight,\r\n        htmlClientHeight: html.clientHeight,\r\n        treeMaxHeight: treeContainer ? treeContainer.style.maxHeight : 'not found'\r\n      };\r\n    },\r\n    navigation: {\r\n      isNavigating: () => NavigationHelper.isNavigating(),\r\n    },\r\n    pdf: {\r\n      isPdf: (url) => isPdfUrl(url),\r\n      getIconUrl: () => chrome.runtime.getURL('assets/icon-pdf.svg'),\r\n      testUrls: () => {\r\n        const testUrls = [\r\n          'chrome-extension://oemmndcbldboiebfnladdacbdfmadadm/file:///Users/jake/Library/Mobile%20Documents/com~apple~CloudDocs/Documents/%E6%8A%80%E6%9C%AF/%E6%8A%80%E6%9C%AF%E5%A4%A7%E4%BC%9A/qc5.pdf',\r\n          'file:///Users/jake/Library/Mobile%20Documents/com~apple~CloudDocs/Documents/%E6%8A%80%E6%9C%AF/%E6%8A%80%E6%9C%.pdf',\r\n          'https://example.com/document.pdf',\r\n          'https://google.com',\r\n          'file:///path/to/document.txt'\r\n        ];\r\n        console.log('\uD83D\uDD0D PDF URL Detection Test:');\r\n        console.log('\uD83D\uDCC4 PDF Icon URL:', chrome.runtime.getURL('assets/icon-pdf.svg'));\r\n        testUrls.forEach(url => {\r\n          const result = isPdfUrl(url);\r\n          console.log(`${result ? '\u2705' : '\u274C'} ${url} \u2192 ${result}`);\r\n        });\r\n        return testUrls.map(url => ({ url, isPdf: isPdfUrl(url) }));\r\n      }\r\n    },\r\n    tabStatus: {\r\n      checkAllTabs: async () => {\r\n        try {\r\n          const tabs = await chrome.tabs.query({});\r\n          const statusInfo = tabs.map(tab => ({\r\n            id: tab.id,\r\n            title: tab.title,\r\n            url: tab.url,\r\n            active: tab.active,\r\n            discarded: tab.discarded,\r\n            status: tab.status,\r\n            loaded: tab.status === 'complete'\r\n          }));\r\n          console.log('\uD83D\uDD04 All tabs status:');\r\n          console.table(statusInfo);\r\n          const unloadedTabs = statusInfo.filter(tab => tab.discarded || tab.status === 'unloaded');\r\n          console.log('\uD83D\uDCF4 Unloaded tabs count:', unloadedTabs.length);\r\n          return statusInfo;\r\n        } catch (error) {\r\n          console.error('Error checking tab status:', error);\r\n          return [];\r\n        }\r\n      },\r\n      checkUnloadedNodes: () => {\r\n        const unloadedNodes = document.querySelectorAll('.tree-node.unloaded');\r\n        const allNodes = document.querySelectorAll('.tree-node');\r\n        console.log('\uD83C\uDFA8 Unloaded nodes in DOM:', unloadedNodes.length, '/', allNodes.length);\r\n        const unloadedInfo = Array.from(unloadedNodes).map(node => ({\r\n          tabId: node.dataset.tabId,\r\n          title: node.querySelector('.tree-title')?.textContent,\r\n          url: node.dataset.tabUrl\r\n        }));\r\n        console.table(unloadedInfo);\r\n        return unloadedInfo;\r\n      },\r\n      refreshUnloadedStatus: async () => {\r\n        console.log('\uD83D\uDD04 Refreshing unloaded status...');\r\n        await loadTabTree();\r\n      }\r\n    }\r\n  };\r\n}\r\n", "// ===================\r\n// popup \u5165\u53E3\uFF1ADOMContentLoaded \u521D\u59CB\u5316 + \u6A21\u5757\u8FDE\u7EBF\r\n// ===================\r\nimport { state } from './modules/state.js';\r\nimport { calculateTreeHeight } from './modules/layout.js';\r\nimport { loadTabTree, updateNavigationButtons, registerSearchHistorySaver, registerActivateTabFn } from './modules/tree.js';\r\nimport { activateTabAndWindow } from './modules/tab-actions.js';\r\nimport { performSearch, clearSearch, renderChipsLayer, renderTagSuggestions, loadRecentPreference, saveSearchHistory, initializeSearch } from './modules/search.js';\r\nimport { installDebugGlobals } from './modules/debug.js';\r\n\r\n// \u6CE8\u5165\u56DE\u8C03\uFF0C\u907F\u514D tree.js \u53CD\u5411\u4F9D\u8D56 search.js / tab-actions.js\r\nregisterSearchHistorySaver(saveSearchHistory);\r\nregisterActivateTabFn(activateTabAndWindow);\r\n\r\n// DOM\u52A0\u8F7D\u5B8C\u6210\u540E\u521D\u59CB\u5316\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n  // \u83B7\u53D6\u5F53\u524D\u6D3B\u52A8\u6807\u7B7E\u9875\r\n  const [activeTab] = await chrome.tabs.query({ active: true, currentWindow: true });\r\n  if (activeTab) {\r\n    state.currentTabId = activeTab.id;\r\n  }\r\n\r\n  // \u8BFB\u53D6\"\u6700\u8FD1\"\u9ED8\u8BA4\u504F\u597D\u5E76\u5E94\u7528\r\n  let preferRecent = false;\r\n  try {\r\n    preferRecent = await loadRecentPreference();\r\n  } catch {}\r\n\r\n  if (preferRecent) {\r\n    state.selectedFilters.recent = true;\r\n    renderChipsLayer();\r\n    await performSearch(document.getElementById('searchInput')?.value || '');\r\n  } else {\r\n    // \u7ACB\u5373\u5237\u65B0\u5E76\u52A0\u8F7D\u6811\u5F62\u7ED3\u6784\r\n    await loadTabTree();\r\n    // \u7ACB\u5373\u641C\u7D22\r\n    performSearch('');\r\n  }\r\n\r\n  // \u7ED1\u5B9A\u524D\u8FDB\u540E\u9000\u6309\u94AE\u4E8B\u4EF6\r\n  document.getElementById('backBtn').addEventListener('click', async () => {\r\n    if (window.tabHistory) {\r\n      const prevTabId = await window.tabHistory.getPreviousTab();\r\n      if (prevTabId) {\r\n        activateTabAndWindow(prevTabId);\r\n      }\r\n      // \u5237\u65B0\u6309\u94AE\u72B6\u6001\uFF08getPreviousTab \u53EF\u80FD\u5DF2\u6E05\u7406\u65E0\u6548\u5386\u53F2\u6761\u76EE\uFF09\r\n      await updateNavigationButtons();\r\n    }\r\n  });\r\n\r\n  document.getElementById('forwardBtn').addEventListener('click', async () => {\r\n    if (window.tabHistory) {\r\n      const nextTabId = await window.tabHistory.getNextTab();\r\n      if (nextTabId) {\r\n        activateTabAndWindow(nextTabId);\r\n      }\r\n      // \u5237\u65B0\u6309\u94AE\u72B6\u6001\uFF08getNextTab \u53EF\u80FD\u5DF2\u6E05\u7406\u65E0\u6548\u5386\u53F2\u6761\u76EE\uFF09\r\n      await updateNavigationButtons();\r\n    }\r\n  });\r\n\r\n  // \u5237\u65B0\u6309\u94AE\r\n  const refreshBtn = document.getElementById('refreshBtn');\r\n  if (refreshBtn) {\r\n    refreshBtn.addEventListener('click', async () => {\r\n      await loadTabTree();\r\n    });\r\n  }\r\n\r\n  // \u5BFC\u51FA\u6309\u94AE\r\n  document.getElementById('exportBtn').addEventListener('click', async () => {\r\n    try {\r\n      if (!window.__exportModuleLoaded) {\r\n        await loadScriptOnce('../shared/export.js');\r\n        window.__exportModuleLoaded = true;\r\n      }\r\n      await exportTabTree();\r\n    } catch (e) {\r\n      console.error('Failed to load export module:', e);\r\n    }\r\n  });\r\n\r\n  // \u81EA\u52A8\u6574\u7406\u6309\u94AE\r\n  document.getElementById('organizeBtn').addEventListener('click', async () => {\r\n    try {\r\n      if (!window.AutoOrganizer && !window.autoOrganizer) {\r\n        if (!window.__organizeModuleLoaded) {\r\n          await loadScriptOnce('../shared/auto-organize.js');\r\n          window.__organizeModuleLoaded = true;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to load auto-organize module:', e);\r\n    }\r\n    const AutoOrganizerClass = window.AutoOrganizer;\r\n    const autoOrganizerInstance = window.autoOrganizer;\r\n\r\n    if (AutoOrganizerClass) {\r\n      const organizer = new AutoOrganizerClass();\r\n      await organizer.organizeTabsByDomain();\r\n      await loadTabTree();\r\n    } else if (autoOrganizerInstance) {\r\n      await autoOrganizerInstance.organizeTabsByDomain();\r\n      await loadTabTree();\r\n    } else {\r\n      console.error('AutoOrganizer not loaded. Available window objects:', Object.keys(window).filter(key => key.toLowerCase().includes('organ')));\r\n    }\r\n  });\r\n\r\n  // \u8BA1\u7B97\u6811\u5F62\u7ED3\u6784\u9AD8\u5EA6\r\n  calculateTreeHeight();\r\n  // \u521D\u59CB\u5316\u5BFC\u822A\u6309\u94AE\u72B6\u6001\r\n  await updateNavigationButtons();\r\n  // \u521D\u59CB\u5316\u56FD\u9645\u5316\r\n  initI18n();\r\n\r\n  // \u641C\u7D22\u6846\u4EA4\u4E92\r\n  const searchInput = document.getElementById('searchInput');\r\n  if (searchInput) {\r\n    searchInput.addEventListener('focus', () => {\r\n      renderTagSuggestions();\r\n    });\r\n\r\n    // Windows \u4E0B\u8865\u4E00\u4E2A click/mousedown \u89E6\u53D1\uFF0C\u4FDD\u8BC1 tagSuggestions \u7A33\u5B9A\u663E\u793A\r\n    const ensureTagSuggestions = () => {\r\n      try { renderTagSuggestions(); } catch {}\r\n    };\r\n    searchInput.addEventListener('mousedown', ensureTagSuggestions);\r\n    searchInput.addEventListener('click', ensureTagSuggestions);\r\n    ensureTagSuggestions();\r\n\r\n    // \u56DE\u8F66\u4FDD\u5B58\u5386\u53F2\r\n    searchInput.addEventListener('keydown', async (e) => {\r\n      if (e.key === 'Enter') {\r\n        await saveSearchHistory(searchInput.value);\r\n        renderTagSuggestions();\r\n      }\r\n      // \u9000\u683C\u884C\u4E3A\uFF1A\u5F53\u8F93\u5165\u4E3A\u7A7A\u65F6\uFF0C\u4F9D\u6B21\u5220\u9664\u6700\u540E\u4E00\u4E2A\u6807\u7B7E\r\n      if (e.key === 'Backspace' && (searchInput.value || '').trim() === '') {\r\n        let removed = false;\r\n        if (state.selectedFilters.historyTerm) {\r\n          state.selectedFilters.historyTerm = null;\r\n          removed = true;\r\n        } else if (state.selectedFilters.recent) {\r\n          state.selectedFilters.recent = false;\r\n          removed = true;\r\n        } else if (state.selectedFilters.bookmarked) {\r\n          state.selectedFilters.bookmarked = false;\r\n          removed = true;\r\n        }\r\n        if (removed) {\r\n          e.preventDefault();\r\n          renderChipsLayer();\r\n          await performSearch('');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // \u521D\u59CB\u5316\u641C\u7D22\u529F\u80FD\uFF08\u7ED1\u5B9A input/\u6E05\u9664\u6309\u94AE\u4E8B\u4EF6\uFF09\r\n  initializeSearch();\r\n\r\n  // \u5B89\u88C5\u8C03\u8BD5\u5168\u5C40\u53D8\u91CF\r\n  installDebugGlobals(performSearch);\r\n});\r\n\r\n// --------------------\r\n// \u517C\u5BB9\u65E7\u4EE3\u7801\uFF1AloadScriptOnce \u5728 export/organize \u6309\u94AE\u4E2D\u4F7F\u7528\r\n// --------------------\r\nfunction loadScriptOnce(src) {\r\n  return new Promise((resolve, reject) => {\r\n    if (document.querySelector(`script[data-dynamic=\"${src}\"]`)) {\r\n      resolve();\r\n      return;\r\n    }\r\n    const s = document.createElement('script');\r\n    s.src = src;\r\n    s.async = true;\r\n    s.defer = true;\r\n    s.dataset.dynamic = src;\r\n    s.onload = () => resolve();\r\n    s.onerror = (e) => reject(e);\r\n    document.body.appendChild(s);\r\n  });\r\n}\r\n"],
  "mappings": ";;AACO,MAAM,QAAQ;AAAA;AAAA,IAEnB,gBAAgB,oBAAI,IAAI;AAAA,IACxB,cAAc;AAAA;AAAA,IAGd,iBAAiB;AAAA,IACjB,kBAAkB;AAAA;AAAA,IAGlB,iBAAiB,CAAC;AAAA,IAClB,cAAc,CAAC;AAAA,IACf,eAAe,oBAAI,IAAI;AAAA,IACvB,mBAAmB;AAAA;AAAA,IAGnB,iBAAiB,EAAE,YAAY,OAAO,QAAQ,OAAO,aAAa,MAAM,YAAY,MAAM;AAAA,IAC1F,eAAe,CAAC;AAAA,IAChB,wBAAwB;AAAA,IACxB,sBAAsB;AAAA,IACtB,mBAAmB;AAAA;AAAA,IAGnB,2BAA2B;AAAA,EAC7B;;;ACrBO,WAAS,sBAAsB;AACpC,UAAM,gBAAgB,SAAS,eAAe,eAAe;AAC7D,QAAI,CAAC,cAAe;AAEpB,UAAM,mBAAmB,SAAS,KAAK,eAAe,SAAS,KAAK,eAAe;AACnF,YAAQ,IAAI,oBAAoB,SAAS,KAAK,cAAc,oBAAoB,SAAS,KAAK,YAAY;AAC1G,UAAM,mBAAmB,SAAS,gBAAgB,eAAe,SAAS,gBAAgB,eAAe;AACzG,YAAQ,IAAI,oBAAoB,SAAS,gBAAgB,cAAc,oBAAoB,SAAS,gBAAgB,YAAY;AAEhI,QAAI,CAAC,oBAAoB,CAAC,kBAAkB;AAC1C,cAAQ,IAAI,8DAAuD;AACnE;AAAA,IACF;AAEA,YAAQ,IAAI,6DAAsD;AAElE,UAAM,cAAc,OAAO,eAAe,SAAS,KAAK,gBAAgB;AACxE,QAAI,aAAa;AAEjB,UAAM,YAAY,iBAAiB,SAAS,IAAI;AAChD,kBAAc,SAAS,UAAU,UAAU,IAAI,SAAS,UAAU,aAAa;AAE/E,UAAM,SAAS,SAAS,cAAc,SAAS;AAC/C,QAAI,QAAQ;AACV,oBAAc,OAAO;AACrB,YAAM,cAAc,iBAAiB,MAAM;AAC3C,oBAAc,SAAS,YAAY,YAAY,IAAI,SAAS,YAAY,aAAa;AAAA,IACvF;AAEA,UAAM,kBAAkB,SAAS,cAAc,mBAAmB;AAClE,QAAI,iBAAiB;AACnB,oBAAc,gBAAgB;AAC9B,YAAM,cAAc,iBAAiB,eAAe;AACpD,oBAAc,SAAS,YAAY,YAAY;AAAA,IACjD;AAEA,UAAM,kBAAkB,cAAc,aAAa,KAAK;AACxD,UAAM,cAAc,KAAK,IAAI,KAAK,KAAK,IAAI,KAAK,eAAe,CAAC;AAEhE,kBAAc,MAAM,YAAY,GAAG,WAAW;AAE9C,YAAQ,IAAI,iCAA0B;AAAA,MACpC;AAAA,MACA;AAAA,MACA;AAAA,MACA,aAAa,cAAc;AAAA,IAC7B,CAAC;AAAA,EACH;;;AC7CO,WAAS,kBAAkB,KAAK;AACrC,QAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;AACnC,aAAO;AAAA,IACT;AAGA,QAAI,IAAI,WAAW,WAAW,KAC1B,IAAI,WAAW,qBAAqB,KACpC,IAAI,WAAW,kBAAkB,KACjC,IAAI,WAAW,qBAAqB,GAAG;AACzC,aAAO;AAAA,IACT;AAGA,QAAI,IAAI,WAAW,UAAU,KACzB,IAAI,WAAW,SAAS,KACxB,IAAI,WAAW,OAAO,KACtB,IAAI,WAAW,OAAO,GAAG;AAC3B,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAEO,WAAS,mBAAmB,QAAQ,SAAS;AAClD,QAAI,CAAC,OAAQ;AACb,QAAI,SAAS;AACX,aAAO,UAAU,IAAI,kBAAkB;AAEvC,aAAO,MAAM,kBAAkB;AAAA,IACjC,OAAO;AACL,aAAO,UAAU,OAAO,kBAAkB;AAAA,IAC5C;AAAA,EACF;AAEO,WAAS,oBAAoB,QAAQ,KAAK,QAAQ,UAAU,eAAe;AAChF,QAAI,CAAC,OAAQ;AACb,QAAI,OAAQ,QAAO,QAAQ,gBAAgB;AAG3C,QAAI,CAAC,OAAO,CAAC,kBAAkB,GAAG,GAAG;AACnC,yBAAmB,QAAQ,IAAI;AAC/B,aAAO,MAAM,kBAAkB;AAC/B;AAAA,IACF;AAGA,uBAAmB,QAAQ,IAAI;AAE/B,UAAM,MAAM,IAAI,MAAM;AACtB,QAAI,SAAS,MAAM;AAEjB,UAAI,CAAC,OAAO,YAAa;AACzB,aAAO,MAAM,kBAAkB,QAAQ,GAAG;AAC1C,aAAO,MAAM,kBAAkB,WAAW;AAC1C,yBAAmB,QAAQ,KAAK;AAAA,IAClC;AACA,QAAI,UAAU,MAAM;AAElB,UAAI,CAAC,OAAO,YAAa;AACzB,aAAO,MAAM,kBAAkB;AAC/B,yBAAmB,QAAQ,IAAI;AAAA,IACjC;AACA,QAAI,MAAM;AAAA,EACZ;AAEA,iBAAe,sCAAsC;AACnD,UAAM,QAAQ,OAAO;AACrB,QAAI,CAAC,MAAO;AAEZ,UAAM,MAAM,aAAa;AAEzB,UAAM,QAAQ,SAAS,iBAAiB,YAAY;AACpD,eAAW,UAAU,OAAO;AAC1B,YAAM,SAAS,OAAO,cAAc,YAAY;AAChD,UAAI,CAAC,OAAQ;AACb,UAAI,OAAO,QAAQ,kBAAkB,WAAY;AAEjD,YAAM,SAAS,OAAO,QAAQ,UAAU;AACxC,YAAM,aAAa,OAAO,QAAQ,cAAc;AAEhD,YAAM,QAAQ,MAAM,MAAM,yBAAyB,MAAM;AACzD,YAAM,eAAe,SAAS,CAAC,MAAM,YAAY,MAAM,WAAW,MAAM,QAAQ,WAAW,OAAO,KAAO,KAAK,IAAI,KAAK,MAAM,MAAM,MAAO,MAAM;AAChJ,UAAI,gBAAgB,kBAAkB,MAAM,OAAO,GAAG;AACpD,4BAAoB,QAAQ,MAAM,SAAS,cAAc;AACzD;AAAA,MACF;AAGA,UAAI,cAAc,kBAAkB,UAAU,GAAG;AAC/C,4BAAoB,QAAQ,YAAY,YAAY;AAAA,MACtD,OAAO;AACL,eAAO,QAAQ,gBAAgB,OAAO,QAAQ,iBAAiB;AAE/D,eAAO,UAAU,IAAI,kBAAkB;AAAA,MACzC;AAGA,aAAO,QAAQ,gBAAgB,OAAO,QAAQ,iBAAiB;AAC/D,YAAM,SAAS,MAAM,MAAM,kBAAkB,QAAQ,cAAc,IAAI;AACvE,aAAO,QAAQ,gBAAgB,QAAQ,UAAU;AACjD,UAAI,QAAQ,WAAW,kBAAkB,OAAO,OAAO,KAAK,OAAO,aAAa;AAC9E,4BAAoB,QAAQ,OAAO,SAAS,OAAO,UAAU,SAAS;AAAA,MACxE;AAAA,IACF;AAAA,EACF;AAEO,WAAS,yBAAyB;AAEvC,QAAI,MAAM,0BAA2B;AACrC,UAAM,4BAA4B;AAClC,eAAW,YAAY;AACrB,YAAM,4BAA4B;AAClC,UAAI;AACF,cAAM,oCAAoC;AAAA,MAC5C,SAAS,GAAG;AAEV,gBAAQ,KAAK,2BAA2B,CAAC;AAAA,MAC3C;AAAA,IACF,GAAG,CAAC;AAAA,EACN;;;ACtHO,MAAM,mBAAmB;AAAA,IAC9B,KAAK;AAAA,MACH,YAAY,CAAC,MAAM;AAAA,MACnB,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,IACA,MAAM;AAAA,MACJ,YAAY,CAAC,SAAS,MAAM;AAAA,MAC5B,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,IACA,KAAK;AAAA,MACH,YAAY,CAAC,MAAM;AAAA,MACnB,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,IACA,KAAK;AAAA,MACH,YAAY,CAAC,QAAQ,OAAO;AAAA,MAC5B,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,IACA,KAAK;AAAA,MACH,YAAY,CAAC,MAAM;AAAA,MACnB,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,IACA,UAAU;AAAA,MACR,YAAY,CAAC,OAAO,WAAW;AAAA,MAC/B,WAAW,CAAC,WAAW,qBAAqB;AAAA,MAC5C,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,IACX;AAAA,EACF;AAOO,WAAS,eAAe,KAAK;AAClC,QAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;AACnC,aAAO;AAAA,IACT;AAKA,QAAI,aAAa;AACjB,QAAI;AACF,mBAAa,mBAAmB,GAAG;AAAA,IACrC,QAAQ;AACN,mBAAa;AAAA,IACf;AACA,UAAM,WAAW,WAAW,YAAY;AAGxC,eAAW,CAAC,UAAU,MAAM,KAAK,OAAO,QAAQ,gBAAgB,GAAG;AAEjE,YAAM,sBAAsB,OAAO,UAAU;AAAA,QAAK,cAChD,SAAS,SAAS,SAAS,YAAY,CAAC;AAAA,MAC1C;AAGA,YAAM,uBAAuB,OAAO,WAAW;AAAA,QAAK,SAClD,SAAS,SAAS,IAAI,YAAY,CAAC;AAAA,MACrC;AAEA,UAAI,uBAAuB,sBAAsB;AAC/C,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAOO,WAAS,kBAAkB,UAAU;AAC1C,WAAO,iBAAiB,QAAQ,KAAK;AAAA,EACvC;AAOO,WAAS,SAAS,KAAK;AAC5B,WAAO,eAAe,GAAG,MAAM;AAAA,EACjC;;;ACzGA,iBAAsB,yBAAyB;AAC7C,QAAI,MAAM,kBAAmB,QAAO,MAAM;AAC1C,QAAI;AACF,YAAM,OAAO,MAAM,OAAO,UAAU,QAAQ;AAC5C,YAAM,MAAM,oBAAI,IAAI;AACpB,YAAM,QAAQ,CAAC,GAAG,IAAI;AACtB,aAAO,MAAM,QAAQ;AACnB,cAAM,OAAO,MAAM,IAAI;AACvB,YAAI,CAAC,KAAM;AACX,YAAI,KAAK,KAAK;AACZ,cAAI;AACF,kBAAM,IAAI,IAAI,IAAI,KAAK,GAAG;AAAG,cAAE,OAAO;AAAI,gBAAI,IAAI,EAAE,IAAI;AAAA,UAC1D,QAAQ;AACN,gBAAI,KAAK,KAAK,OAAO,IAAI,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA,UACxC;AAAA,QACF;AACA,YAAI,KAAK,SAAU,OAAM,KAAK,GAAG,KAAK,QAAQ;AAAA,MAChD;AACA,YAAM,oBAAoB;AAC1B,aAAO;AAAA,IACT,SAAS,GAAG;AACV,YAAM,oBAAoB,oBAAI,IAAI;AAClC,aAAO,MAAM;AAAA,IACf;AAAA,EACF;AAGA,iBAAsB,sBAAsB,UAAU;AACpD,QAAI,CAAC,SAAU,QAAO;AAEtB,QAAI;AACF,YAAM,UAAU,MAAM,OAAO,UAAU,IAAI,QAAQ;AACnD,UAAI,CAAC,WAAW,QAAQ,WAAW,EAAG,QAAO;AAE7C,YAAM,SAAS,QAAQ,CAAC;AAGxB,UAAI,CAAC,OAAO,SAAS,CAAC,OAAO,UAAU;AACrC,eAAO;AAAA,MACT;AAEA,aAAO,OAAO;AAAA,IAChB,SAAS,OAAO;AACd,cAAQ,IAAI,uCAAuC,MAAM,OAAO;AAChE,aAAO;AAAA,IACT;AAAA,EACF;AAGA,iBAAsB,gBAAgB,KAAK,eAAe,OAAO;AAC/D,QAAI,CAAC,IAAK,QAAO,EAAE,cAAc,OAAO,OAAO,MAAM,YAAY,KAAK;AAGtE,QAAI,cAAc;AAChB,UAAI;AACF,cAAM,YAAY,MAAM,OAAO,UAAU,OAAO,EAAE,IAAS,CAAC;AAC5D,cAAM,eAAe,aAAa,UAAU,SAAS;AACrD,YAAI,gBAAgB;AACpB,YAAI,aAAa;AAEjB,YAAI,cAAc;AAChB,gBAAM,WAAW,UAAU,CAAC;AAC5B,0BAAgB,SAAS;AACzB,uBAAa,MAAM,sBAAsB,SAAS,QAAQ;AAAA,QAC5D;AAEA,cAAM,eAAe,EAAE,cAAc,OAAO,eAAe,WAAW;AACtE,cAAM,cAAc,IAAI,KAAK,YAAY;AAEzC,eAAO;AAAA,MACT,SAAS,OAAO;AACd,gBAAQ,IAAI,8BAA8B,MAAM,OAAO;AACvD,eAAO,EAAE,cAAc,OAAO,OAAO,MAAM,YAAY,KAAK;AAAA,MAC9D;AAAA,IACF;AAGA,QAAI,MAAM,cAAc,IAAI,GAAG,GAAG;AAChC,YAAM,aAAa,MAAM,cAAc,IAAI,GAAG;AAE9C,UAAI,OAAO,eAAe,WAAW;AACnC,eAAO,EAAE,cAAc,YAAY,OAAO,MAAM,YAAY,KAAK;AAAA,MACnE,OAAO;AACL,eAAO;AAAA,UACL,cAAc,WAAW,gBAAgB;AAAA,UACzC,OAAO,WAAW,SAAS;AAAA,UAC3B,YAAY,WAAW,cAAc;AAAA,QACvC;AAAA,MACF;AAAA,IACF;AAGA,QAAI;AACF,YAAM,YAAY,MAAM,OAAO,UAAU,OAAO,EAAE,IAAS,CAAC;AAC5D,YAAM,eAAe,aAAa,UAAU,SAAS;AACrD,UAAI,gBAAgB;AACpB,UAAI,aAAa;AAEjB,UAAI,cAAc;AAChB,cAAM,WAAW,UAAU,CAAC;AAC5B,wBAAgB,SAAS;AACzB,qBAAa,MAAM,sBAAsB,SAAS,QAAQ;AAAA,MAC5D;AAEA,YAAM,eAAe,EAAE,cAAc,OAAO,eAAe,WAAW;AACtE,YAAM,cAAc,IAAI,KAAK,YAAY;AAEzC,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,IAAI,8BAA8B,MAAM,OAAO;AACvD,YAAM,YAAY,EAAE,cAAc,OAAO,OAAO,MAAM,YAAY,KAAK;AACvE,YAAM,cAAc,IAAI,KAAK,SAAS;AACtC,aAAO;AAAA,IACT;AAAA,EACF;;;ACjHO,WAAS,sBAAsB,MAAM,aAAa;AACvD,UAAM,aAAa,MAAM,eAAe,IAAI,KAAK,EAAE;AAEnD,QAAI,YAAY;AACd,8BAAwB,IAAI;AAAA,IAC9B,OAAO;AACL,qCAA+B,IAAI;AAAA,IACrC;AAEA,sBAAkB;AAAA,EACpB;AAEA,WAAS,+BAA+B,MAAM;AAC5C,UAAM,eAAe,IAAI,KAAK,EAAE;AAChC,SAAK,SAAS,QAAQ,WAAS;AAC7B,qCAA+B,KAAK;AAAA,IACtC,CAAC;AAAA,EACH;AAEA,WAAS,wBAAwB,MAAM;AACrC,UAAM,eAAe,OAAO,KAAK,EAAE;AACnC,SAAK,SAAS,QAAQ,WAAS;AAC7B,8BAAwB,KAAK;AAAA,IAC/B,CAAC;AAAA,EACH;AAGO,WAAS,oBAAoB;AAClC,aAAS,iBAAiB,YAAY,EAAE,QAAQ,iBAAe;AAC7D,YAAM,QAAQ,SAAS,YAAY,QAAQ,KAAK;AAChD,UAAI,MAAM,eAAe,IAAI,KAAK,GAAG;AACnC,oBAAY,UAAU,IAAI,UAAU;AAAA,MACtC,OAAO;AACL,oBAAY,UAAU,OAAO,UAAU;AAAA,MACzC;AAAA,IACF,CAAC;AAAA,EACH;AAGO,WAAS,qBAAqB;AACnC,QAAI,CAAC,MAAM,aAAc;AAEzB,UAAM,cAAc,SAAS,cAAc,iBAAiB,MAAM,YAAY,IAAI;AAClF,QAAI,aAAa;AACf,YAAM,YAAY,SAAS,eAAe,eAAe;AAEzD,YAAM,UAAU,YAAY,YAAY,YAAY,cAAc;AAClE,YAAM,kBAAkB,UAAU;AAClC,YAAM,aAAa,YAAY;AAE/B,UAAI,UAAU,UAAU,aAAa,UAAU,aAAa,UAAU,YAAY,iBAAiB;AACjG,cAAM,kBAAkB,UAAW,kBAAkB,IAAM,aAAa;AACxE,kBAAU,YAAY,KAAK,IAAI,GAAG,eAAe;AAAA,MACnD;AAAA,IACF;AAAA,EACF;;;ACvDO,WAAS,qBAAqB,OAAO;AAC1C,YAAQ,IAAI,8BAA8B,KAAK,EAAE;AAGjD,WAAO,KAAK,OAAO,OAAO,EAAE,QAAQ,KAAK,GAAG,MAAM;AAChD,UAAI,OAAO,QAAQ,WAAW;AAC5B,gBAAQ,MAAM,yBAAyB,OAAO,QAAQ,SAAS;AAC/D;AAAA,MACF;AAEA,cAAQ,IAAI,OAAO,KAAK,YAAY;AAGpC,aAAO,KAAK,IAAI,OAAO,CAAC,cAAc;AACpC,YAAI,OAAO,QAAQ,WAAW;AAC5B,kBAAQ,MAAM,6BAA6B,OAAO,QAAQ,SAAS;AACnE,iBAAO,MAAM;AACb;AAAA,QACF;AAGA,eAAO,KAAK,MAAM,EAAE,QAAQ,MAAM,eAAe,KAAK,GAAG,CAAC,gBAAgB;AACxE,cAAI,OAAO,QAAQ,aAAa,CAAC,YAAY,CAAC,GAAG;AAC/C,oBAAQ,IAAI,6DAA6D;AAEzE,mBAAO,QAAQ,OAAO,UAAU,UAAU,EAAE,SAAS,KAAK,GAAG,MAAM;AACjE,sBAAQ,IAAI,UAAU,UAAU,QAAQ,UAAU;AAClD,qBAAO,MAAM;AAAA,YACf,CAAC;AACD;AAAA,UACF;AAEA,gBAAM,aAAa,YAAY,CAAC;AAChC,gBAAM,mBAAmB,UAAU,aAAa,WAAW;AAE3D,cAAI,kBAAkB;AACpB,oBAAQ,IAAI,mBAAmB,UAAU,QAAQ,EAAE;AACnD,mBAAO,QAAQ,OAAO,UAAU,UAAU,EAAE,SAAS,KAAK,GAAG,MAAM;AACjE,kBAAI,OAAO,QAAQ,WAAW;AAC5B,wBAAQ,MAAM,0BAA0B,OAAO,QAAQ,SAAS;AAAA,cAClE,OAAO;AACL,wBAAQ,IAAI,UAAU,UAAU,QAAQ,UAAU;AAAA,cACpD;AACA,qBAAO,MAAM;AAAA,YACf,CAAC;AAAA,UACH,OAAO;AACL,oBAAQ,IAAI,gCAAgC;AAC5C,mBAAO,MAAM;AAAA,UACf;AAAA,QACF,CAAC;AAAA,MACH,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAGA,iBAAsB,kBAAkB,QAAQ;AAC9C,WAAO,QAAQ,WAAS;AACtB,YAAM,UAAU,SAAS,cAAc,iBAAiB,KAAK,IAAI;AACjE,UAAI,SAAS;AACX,gBAAQ,OAAO;AAAA,MACjB;AAAA,IACF,CAAC;AAGD,QAAI,OAAO,YAAY;AACrB,YAAM,OAAO,WAAW,sBAAsB,MAAM;AAAA,IACtD;AAAA,EACF;AAGA,iBAAsB,uBAAuB,MAAM;AACjD,QAAI,cAAc,CAAC;AAEnB,QAAI,MAAM,eAAe,OAAO,GAAG;AAEjC,oBAAc,MAAM,KAAK,MAAM,cAAc;AAE7C,YAAM,eAAe,MAAM;AAAA,IAC7B,OAAO;AAEL,UAAS,gBAAT,SAAuBA,OAAM;AAC3B,oBAAY,KAAKA,MAAK,EAAE;AACxB,QAAAA,MAAK,SAAS,QAAQ,WAAS;AAC7B,wBAAc,KAAK;AAAA,QACrB,CAAC;AAAA,MACH;AACA,oBAAc,IAAI;AAAA,IACpB;AAGA,QAAI;AACF,YAAM,OAAO,QAAQ,YAAY;AAAA,QAC/B,QAAQ;AAAA,QACR,QAAQ;AAAA,MACV,CAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,iCAAiC,KAAK;AAAA,IACtD;AAGA,QAAI;AACF,YAAM,OAAO,KAAK,OAAO,WAAW;AAEpC,YAAM,kBAAkB,WAAW;AAAA,IACrC,SAAS,OAAO;AACd,cAAQ,KAAK,uBAAuB,KAAK;AAAA,IAC3C;AAAA,EACF;;;ACtGA,MAAI,qBAAqB,OAAO,UAAU;AAAA,EAAC;AACpC,WAAS,2BAA2B,IAAI;AAC7C,yBAAqB;AAAA,EACvB;AAGA,iBAAsB,0BAA0B;AAC9C,QAAI,CAAC,OAAO,WAAY;AACxB,UAAM,UAAU,SAAS,eAAe,SAAS;AACjD,UAAM,aAAa,SAAS,eAAe,YAAY;AACvD,QAAI,CAAC,WAAW,CAAC,WAAY;AAE7B,UAAM,OAAO,MAAM,OAAO,WAAW,eAAe;AACpD,QAAI,QAAS,SAAQ,WAAW,KAAK,gBAAgB;AACrD,QAAI,WAAY,YAAW,WAAW,KAAK,gBAAgB,KAAK,QAAQ,SAAS;AAEjF,YAAQ,IAAI,gCAAyB;AAAA,MACnC,SAAS,KAAK;AAAA,MACd,cAAc,KAAK;AAAA,MACnB,WAAW,KAAK,eAAe;AAAA,MAC/B,cAAc,KAAK,eAAe,KAAK,QAAQ,SAAS;AAAA,IAC1D,CAAC;AAAA,EACH;AAGO,WAAS,4BAA4B;AAC1C,UAAM,YAAY,SAAS,eAAe,eAAe;AACzD,QAAI,CAAC,UAAW;AAChB,UAAM,aAAa,MAAM,KAAK,UAAU,iBAAiB,mBAAmB,CAAC;AAC7E,UAAM,oBAAoB,CAAC,CAAC,UAAU,cAAc,uDAAuD;AAC3G,eAAW,QAAQ,SAAO;AACxB,YAAM,OAAO,IAAI,QAAQ,iBAAiB;AAC1C,UAAI,SAAS,gBAAgB,CAAC,mBAAmB;AAC/C,YAAI,MAAM,UAAU;AACpB;AAAA,MACF;AACA,UAAI,SAAS,kBAAkB,SAAS,mBAAmB,SAAS,IAAI;AACtE,cAAM,gBAAgB,IAAI,QAAQ,WAAW;AAC7C,YAAI,UAAU,IAAI;AAClB,YAAI,aAAa;AACjB,eAAO,SAAS;AACd,cAAI,QAAQ,aAAa,QAAQ,UAAU,SAAS,kBAAkB,EAAG;AACzE,cAAI,QAAQ,aAAa,QAAQ,UAAU,SAAS,WAAW,KAAK,CAAC,QAAQ,UAAU,SAAS,QAAQ,GAAG;AACzG,gBAAI,SAAS,gBAAgB;AAC3B,oBAAM,cAAc,QAAQ,WAAW,QAAQ,QAAQ;AACvD,kBAAI,gBAAgB,eAAe;AAAE,6BAAa;AAAM;AAAA,cAAO;AAAA,YACjE,OAAO;AACL,2BAAa;AAAM;AAAA,YACrB;AAAA,UACF;AACA,oBAAU,QAAQ;AAAA,QACpB;AACA,YAAI,MAAM,UAAU,aAAa,SAAS;AAAA,MAC5C,WAAW,SAAS,cAAc;AAChC,cAAM,cAAc,IAAI,QAAQ,WAAW;AAC3C,YAAI,UAAU,IAAI;AAClB,YAAI,aAAa;AACjB,eAAO,SAAS;AACd,cAAI,QAAQ,aAAa,QAAQ,UAAU,SAAS,kBAAkB,EAAG;AACzE,cAAI,QAAQ,aAAa,QAAQ,UAAU,SAAS,WAAW,KAAK,CAAC,QAAQ,UAAU,SAAS,QAAQ,GAAG;AACzG,kBAAM,cAAc,QAAQ,WAAW,QAAQ,QAAQ;AACvD,gBAAI,gBAAgB,aAAa;AAAE,2BAAa;AAAM;AAAA,YAAO;AAAA,UAC/D;AACA,oBAAU,QAAQ;AAAA,QACpB;AACA,YAAI,MAAM,UAAU,aAAa,SAAS;AAAA,MAC5C;AAAA,IACF,CAAC;AAAA,EACH;AAqBA,iBAAsB,cAAc;AAClC,YAAQ,IAAI,8BAAuB;AACnC,QAAI;AACF,YAAM,MAAM,KAAK,IAAI;AACrB,UAAI,MAAM,MAAM,kBAAkB,MAAM,kBAAkB;AACxD,cAAM,kBAAkB;AACxB,YAAI;AACF,gBAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,mBAAmB,CAAC;AAAA,QACjE,SAAS,OAAO;AACd,kBAAQ,IAAI,+DAA+D;AAAA,QAC7E;AAAA,MACF;AAGA,UAAI,eAAe,CAAC;AACpB,UAAI,WAAW;AACf,YAAM,cAAc;AAEpB,aAAO,WAAW,aAAa;AAC7B,YAAI;AACF,yBAAe,MAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,kBAAkB,CAAC;AAE7E,cAAI,iBAAiB,QAAW;AAC9B,oBAAQ,IAAI,oCAA6B,WAAW,CAAC,kBAAkB,OAAO,KAAK,YAAY,EAAE,MAAM,YAAY;AACnH;AAAA,UACF,OAAO;AACL,gBAAI,aAAa,GAAG;AAClB,kBAAI;AAAE,sBAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,mBAAmB,CAAC;AAAA,cAAG,QAAQ;AAAA,cAAC;AAAA,YACnF;AACA;AACA,gBAAI,WAAW,aAAa;AAC1B,sBAAQ,IAAI,4CAAuC,QAAQ,IAAI,WAAW,wBAAwB;AAClG,oBAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,YACvD;AAAA,UACF;AAAA,QACF,SAAS,OAAO;AACd;AACA,kBAAQ,IAAI,+CAA0C,QAAQ,IAAI,WAAW,KAAK,KAAK;AACvF,cAAI,WAAW,aAAa;AAC1B,kBAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,UACvD;AAAA,QACF;AAAA,MACF;AAEA,qBAAe,gBAAgB,CAAC;AAEhC,UAAI,YAAY,aAAa;AAC3B,gBAAQ,KAAK,kGAAwF;AAAA,MACvG;AAEA,cAAQ,IAAI,mCAA4B,OAAO,KAAK,YAAY,EAAE,MAAM;AAGxE,UAAI;AACF,cAAM,kBAAkB,MAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,uBAAuB,CAAC,KAAK,CAAC;AACjG,gBAAQ,IAAI,uCAAgC,OAAO,KAAK,MAAM,eAAe,EAAE,MAAM;AAAA,MACvF,SAAS,OAAO;AACd,gBAAQ,IAAI,qCAAqC,KAAK;AACtD,cAAM,kBAAkB,CAAC;AAAA,MAC3B;AAGA,YAAM,OAAO,MAAM,OAAO,KAAK,MAAM,CAAC,CAAC;AAGvC,YAAM,eAAe,CAAC;AACtB,YAAM,eAAe,MAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,oBAAoB,SAAS,gBAAgB,CAAC,EAAE,MAAM,MAAM,KAAK;AACjI,UAAI,gBAAgB,OAAO,aAAa,OAAO,OAAO,UAAU,QAAQ,YAAY;AAClF,YAAI;AACF,gBAAM,WAAW,MAAM,KAAK,IAAI,KAAK,QAAQ,CAAC,GAAG,IAAI,OAAK,EAAE,OAAO,EAAE,OAAO,QAAM,OAAO,OAAO,YAAY,MAAM,CAAC,CAAC,CAAC;AACrH,qBAAW,OAAO,UAAU;AAC1B,gBAAI;AACF,oBAAM,OAAO,MAAM,OAAO,UAAU,IAAI,GAAG;AAC3C,oBAAM,aAAa,GAAG,IAAI,QAAQ,CAAC;AAAA,YACrC,SAAS,GAAG;AACV,oBAAM,aAAa,GAAG,IAAI,CAAC;AAAA,YAC7B;AAAA,UACF;AAAA,QACF,SAAS,GAAG;AACV,gBAAM,eAAe,CAAC;AAAA,QACxB;AAAA,MACF;AAGA,YAAM,OAAO,aAAa,MAAM,YAAY;AAG5C,iBAAW,IAAI;AAEf,6BAAuB;AAAA,IAEzB,SAAS,OAAO;AACd,cAAQ,MAAM,2BAA2B,KAAK;AAAA,IAChD;AAAA,EACF;AAGO,WAAS,aAAa,MAAM,cAAc;AAC/C,UAAM,SAAS,oBAAI,IAAI;AACvB,UAAM,aAAa,CAAC;AACpB,UAAM,aAAa,CAAC;AAGpB,QAAI,MAAM,mBAAmB,MAAM,gBAAgB,QAAQ;AACzD,YAAM,eAAe,MAAM,gBAAgB,OAAO,KAAK,MAAM,YAAY,EAAE,SAAS;AACpF,UAAI,CAAC,cAAc;AACjB,eAAO,KAAK,KAAK,CAAC,GAAG,OAAO,EAAE,gBAAgB,MAAM,EAAE,gBAAgB,EAAE;AAExE,cAAM,YAAY,CAAC,EAAE,MAAM,qBAAqB,MAAM,gBAAgB;AACtE,YAAI,CAAC,WAAW;AACd,iBAAO,KAAK,MAAM,GAAG,EAAE;AAAA,QACzB;AAAA,MACF;AAAA,IACF;AAGA,SAAK,QAAQ,SAAO;AAClB,aAAO,IAAI,IAAI,IAAI;AAAA,QACjB,GAAG;AAAA,QACH,UAAU,CAAC;AAAA,MACb,CAAC;AAAA,IACH,CAAC;AAGD,SAAK,QAAQ,SAAO;AAClB,YAAM,WAAW,aAAa,IAAI,EAAE;AACpC,UAAI,YAAY,OAAO,IAAI,QAAQ,GAAG;AACpC,cAAM,SAAS,OAAO,IAAI,QAAQ;AAClC,cAAM,QAAQ,OAAO,IAAI,IAAI,EAAE;AAC/B,eAAO,SAAS,KAAK,KAAK;AAAA,MAC5B,OAAO;AACL,cAAM,UAAU,OAAO,IAAI,IAAI,EAAE;AACjC,cAAM,WAAW,MAAM,mBAAmB,MAAM,gBAAgB,IAAI,EAAE;AACtE,YAAI,UAAU;AACZ,qBAAW,KAAK,OAAO;AAAA,QACzB,OAAO;AACL,qBAAW,KAAK,OAAO;AAAA,QACzB;AAAA,MACF;AAAA,IACF,CAAC;AAGD,QAAI,CAAC,MAAM,mBAAmB,CAAC,MAAM,gBAAgB,QAAQ;AAC3D,iBAAW,KAAK,CAAC,GAAG,MAAM;AACxB,cAAM,aAAa,MAAM,gBAAgB,EAAE,EAAE,GAAG,aAAa;AAC7D,cAAM,aAAa,MAAM,gBAAgB,EAAE,EAAE,GAAG,aAAa;AAC7D,eAAO,aAAa;AAAA,MACtB,CAAC;AACD,iBAAW,KAAK,CAAC,GAAG,MAAM;AACxB,YAAI,EAAE,aAAa,EAAE,SAAU,QAAO,EAAE,WAAW,EAAE;AACrD,eAAO,EAAE,QAAQ,EAAE;AAAA,MACrB,CAAC;AAAA,IACH,OAAO;AACL,YAAM,eAAe,MAAM,gBAAgB,OAAO,KAAK,MAAM,YAAY,EAAE,SAAS;AACpF,UAAI,cAAc;AAChB,mBAAW,KAAK,CAAC,GAAG,MAAM;AACxB,gBAAM,SAAU,OAAO,EAAE,YAAY,YAAY,EAAE,WAAW,IAAK,EAAE,UAAU,OAAO;AACtF,gBAAM,SAAU,OAAO,EAAE,YAAY,YAAY,EAAE,WAAW,IAAK,EAAE,UAAU,OAAO;AACtF,cAAI,WAAW,OAAQ,QAAO,SAAS;AACvC,gBAAM,QAAQ,EAAE,gBAAgB;AAChC,gBAAM,QAAQ,EAAE,gBAAgB;AAChC,iBAAO,QAAQ;AAAA,QACjB,CAAC;AAAA,MACH,OAAO;AACL,mBAAW,KAAK,CAAC,GAAG,OAAO,EAAE,gBAAgB,MAAM,EAAE,gBAAgB,EAAE;AAAA,MACzE;AAAA,IACF;AAEA,WAAO,CAAC,GAAG,YAAY,GAAG,UAAU;AAAA,EACtC;AAGO,WAAS,WAAW,MAAM;AAC/B,UAAM,YAAY,SAAS,eAAe,eAAe;AACzD,cAAU,YAAY;AAEtB,QAAI,aAAa,KAAK,OAAO,UAAQ,MAAM,mBAAmB,MAAM,gBAAgB,KAAK,EAAE,CAAC;AAC5F,QAAI,aAAa,KAAK,OAAO,UAAQ,CAAC,MAAM,mBAAmB,CAAC,MAAM,gBAAgB,KAAK,EAAE,CAAC;AAG9F,QAAI,WAAW,SAAS,GAAG;AACzB,YAAM,SAAS,SAAS,cAAc,KAAK;AAC3C,aAAO,YAAY;AACnB,aAAO,QAAQ,gBAAgB;AAC/B,YAAM,QAAQ,SAAS,cAAc,MAAM;AAC3C,YAAM,YAAY;AAClB,YAAM,cAAc,KAAK,YAAY,KAAK;AAC1C,YAAM,OAAO,SAAS,cAAc,KAAK;AACzC,WAAK,YAAY;AACjB,aAAO,YAAY,KAAK;AACxB,aAAO,YAAY,IAAI;AACvB,gBAAU,YAAY,MAAM;AAAA,IAC9B;AAGA,eAAW,QAAQ,CAAC,SAAS;AAC3B,WAAK,UAAU;AACf,iBAAW,MAAM,WAAW,GAAG,CAAC,GAAG,KAAK;AAAA,IAC1C,CAAC;AAGD,UAAM,eAAe,MAAM,gBAAgB,OAAO,KAAK,MAAM,YAAY,EAAE,SAAS;AACpF,QAAI,cAAc;AAClB,QAAI,eAAe;AACnB,eAAW,QAAQ,CAAC,MAAM,OAAO,UAAU;AACzC,YAAM,cAAe,OAAO,KAAK,YAAY,WAAY,KAAK,UAAU;AACxE,YAAM,eAAe,KAAK;AAC1B,YAAM,gBAAgB,gBAAgB;AAEtC,YAAM,gBAAgB,QAAQ,KAAK,iBAAiB;AACpD,YAAM,eAAe,UAAU,IAAI,QAAS,iBAAiB,gBAAgB;AAE7E,UAAI,gBAAgB,kBAAmB,UAAU,KAAM,eAAe;AACpE,cAAM,SAAS,SAAS,cAAc,KAAK;AAC3C,eAAO,YAAY;AACnB,eAAO,QAAQ,gBAAgB;AAC/B,eAAO,QAAQ,UAAU,OAAO,WAAW;AAE3C,cAAM,QAAQ,SAAS,cAAc,MAAM;AAC3C,cAAM,YAAY;AAClB,cAAM,QAAS,MAAM,aAAa,WAAW,KAAK,MAAM,aAAa,WAAW,EAAE,QAAS,MAAM,aAAa,WAAW,EAAE,QAAS,KAAK,UAAU,KAAK;AACxJ,cAAM,cAAc;AAEpB,cAAM,OAAO,SAAS,cAAc,KAAK;AACzC,aAAK,YAAY;AAEjB,eAAO,YAAY,KAAK;AACxB,eAAO,YAAY,IAAI;AACvB,kBAAU,YAAY,MAAM;AAAA,MAC9B;AAEA,iBAAW,MAAM,WAAW,GAAG,CAAC,GAAG,UAAU,MAAM,SAAS,CAAC;AAE7D,oBAAc;AACd,qBAAe;AAAA,IACjB,CAAC;AAGD,QAAI,gBAAgB,WAAW,SAAS,GAAG;AACzC,YAAM,WAAW,WAAW,WAAW,SAAS,CAAC;AACjD,YAAM,cAAe,OAAO,SAAS,YAAY,WAAY,SAAS,UAAU;AAChF,UAAI,gBAAgB,IAAI;AACtB,cAAM,OAAO,SAAS,cAAc,KAAK;AACzC,aAAK,YAAY;AACjB,aAAK,QAAQ,gBAAgB;AAC7B,aAAK,QAAQ,UAAU,OAAO,WAAW;AACzC,cAAM,WAAW,SAAS,cAAc,KAAK;AAC7C,iBAAS,YAAY;AACrB,aAAK,YAAY,QAAQ;AACzB,kBAAU,YAAY,IAAI;AAAA,MAC5B;AAAA,IACF;AAGA,8BAA0B;AAE1B,2BAAuB;AAAA,EACzB;AAGO,WAAS,WAAW,MAAM,WAAW,OAAO,cAAc,CAAC,GAAG,SAAS,OAAO;AACnF,UAAM,cAAc,SAAS,cAAc,KAAK;AAChD,gBAAY,YAAY;AACxB,gBAAY,QAAQ,QAAQ,KAAK;AACjC,gBAAY,QAAQ,SAAS,KAAK,OAAO;AACzC,gBAAY,QAAQ,aAAa,KAAK,cAAc;AACpD,gBAAY,QAAQ,UAAW,OAAO,KAAK,YAAY,YAAY,KAAK,WAAW,IAAK,OAAO,KAAK,OAAO,IAAI;AAE/G,QAAI,KAAK,OAAO,MAAM,cAAc;AAClC,kBAAY,UAAU,IAAI,aAAa;AAAA,IACzC;AAEA,QAAI,KAAK,aAAa,KAAK,WAAW,YAAY;AAChD,kBAAY,UAAU,IAAI,UAAU;AAAA,IACtC;AAEA,UAAM,WAAW,MAAM,mBAAmB,MAAM,gBAAgB,KAAK,EAAE;AACvE,QAAI,UAAU;AACZ,kBAAY,UAAU,IAAI,YAAY;AACtC,cAAQ,IAAI,4CAAqC,KAAK,IAAI,KAAK,KAAK;AAAA,IACtE;AAGA,UAAM,OAAO,SAAS,cAAc,KAAK;AACzC,SAAK,YAAY;AACjB,SAAK,QAAQ,gBAAgB;AAC7B,SAAK,UAAU,IAAI,kBAAkB;AAErC,UAAM,WAAW,eAAe,KAAK,GAAG;AACxC,QAAI,UAAU;AACZ,YAAM,SAAS,kBAAkB,QAAQ;AACzC,UAAI,QAAQ;AACV,cAAM,UAAU,OAAO,QAAQ,OAAO,OAAO,IAAI;AACjD,4BAAoB,MAAM,SAAS,YAAY,OAAO,WAAW,aAAa;AAC9E,aAAK,MAAM,iBAAiB;AAC5B,aAAK,MAAM,mBAAmB;AAC9B,aAAK,MAAM,qBAAqB;AAChC,aAAK,MAAM,QAAQ;AACnB,aAAK,MAAM,SAAS;AACpB,aAAK,YAAY;AACjB,aAAK,QAAQ,KAAK,OAAO,KAAK;AAAA,MAChC;AACA,WAAK,QAAQ,gBAAgB;AAAA,IAC/B,OAAO;AACL,WAAK,MAAM,kBAAkB;AAC7B,WAAK,MAAM,kBAAkB;AAC7B,WAAK,QAAQ,gBAAgB;AAAA,IAC/B;AAGA,UAAM,SAAS,SAAS,cAAc,KAAK;AAC3C,WAAO,YAAY;AACnB,WAAO,MAAM,YAAY,WAAW,OAAO,KAAK,CAAC;AAEjD,aAAS,IAAI,GAAG,IAAI,KAAK,IAAI,GAAG,QAAQ,CAAC,GAAG,KAAK;AAC/C,YAAM,MAAM,SAAS,cAAc,KAAK;AACxC,UAAI,YAAY;AAChB,UAAI,IAAI,YAAY,UAAU,YAAY,CAAC,GAAG;AAC5C,YAAI,UAAU,IAAI,UAAU;AAAA,MAC9B;AACA,aAAO,YAAY,GAAG;AAAA,IACxB;AAEA,QAAI,QAAQ,GAAG;AACb,YAAM,WAAW,SAAS,cAAc,KAAK;AAC7C,eAAS,YAAY;AACrB,eAAS,UAAU,IAAI,SAAS,YAAY,QAAQ;AACpD,aAAO,YAAY,QAAQ;AAAA,IAC7B;AAEA,UAAM,UAAU,SAAS,cAAc,KAAK;AAC5C,YAAQ,YAAY;AACpB,YAAQ,YAAY,IAAI;AACxB,WAAO,YAAY,OAAO;AAE1B,gBAAY,YAAY,MAAM;AAG9B,UAAM,QAAQ,SAAS,cAAc,KAAK;AAC1C,UAAM,YAAY;AAClB,UAAM,cAAc,KAAK,SAAS,KAAK;AACvC,UAAM,QAAQ,GAAG,KAAK,KAAK;AAAA;AAAA,EAAO,KAAK,GAAG;AAC1C,gBAAY,YAAY,KAAK;AAG7B,UAAM,kBAAkB,SAAS,cAAc,KAAK;AACpD,oBAAgB,YAAY;AAE5B,QAAI,KAAK,SAAS;AAChB,YAAM,cAAc,SAAS,cAAc,MAAM;AACjD,kBAAY,cAAc;AAC1B,kBAAY,YAAY;AACxB,kBAAY,QAAQ,KAAK,cAAc;AACvC,sBAAgB,YAAY,WAAW;AAAA,IACzC,WAAW,KAAK,aAAa,KAAK,UAAU,OAAO;AACjD,YAAM,cAAc,SAAS,cAAc,MAAM;AACjD,kBAAY,cAAc;AAC1B,kBAAY,YAAY;AACxB,kBAAY,QAAQ,KAAK,YAAY;AACrC,sBAAgB,YAAY,WAAW;AAAA,IACzC;AAGA,UAAM,eAAe,KAAK,OAAO,MAAM;AACvC,oBAAgB,KAAK,KAAK,YAAY,EAAE,KAAK,kBAAgB;AAC3D,UAAI,cAAc,GAAG,KAAK,KAAK;AAE/B,UAAI,aAAa,gBAAgB,aAAa,SAAS,aAAa,MAAM,KAAK,GAAG;AAChF,cAAM,cAAc,aAAa;AAEjC,YAAI,KAAK,UAAU,aAAa,OAAO;AACrC,wBAAc,aAAM,KAAK,mBAAmB,CAAC,KAAK,KAAK,KAAK;AAAA,QAC9D,OAAO;AACL,wBAAc,aAAM,KAAK,mBAAmB,CAAC,KAAK,KAAK,KAAK;AAAA,YAAQ,KAAK,sBAAsB,CAAC,KAAK,aAAa,KAAK;AAAA,QACzH;AAAA,MACF;AAEA,UAAI,aAAa,gBAAgB,aAAa,YAAY;AACxD,uBAAe;AAAA,YAAQ,KAAK,oBAAoB,CAAC,KAAK,aAAa,UAAU;AAAA,MAC/E;AAEA,YAAM,QAAQ,cAAc;AAAA;AAAA,EAAO,KAAK,GAAG;AAE3C,UAAI,aAAa,cAAc;AAC7B,cAAM,iBAAiB,SAAS,cAAc,MAAM;AACpD,uBAAe,cAAc;AAC7B,uBAAe,YAAY;AAC3B,uBAAe,QAAQ,KAAK,eAAe;AAC3C,wBAAgB,YAAY,cAAc;AAAA,MAC5C;AAAA,IACF,CAAC,EAAE,MAAM,WAAS;AAChB,cAAQ,IAAI,gCAAgC,MAAM,OAAO;AAAA,IAC3D,CAAC;AAED,gBAAY,YAAY,eAAe;AAGvC,UAAM,mBAAmB,SAAS,cAAc,KAAK;AACrD,qBAAiB,YAAY;AAG7B,UAAM,qBAAqB,SAAS,cAAc,KAAK;AACvD,uBAAmB,YAAY;AAE/B,UAAM,YAAY,SAAS,cAAc,QAAQ;AACjD,cAAU,YAAY;AACtB,cAAU,cAAc;AACxB,cAAU,QAAQ,KAAK,YAAY;AAEnC,UAAM,gBAAgB,SAAS,cAAc,KAAK;AAClD,kBAAc,YAAY;AAC1B,kBAAc,iBAAiB,SAAS,CAAC,MAAM;AAC7C,QAAE,gBAAgB;AAClB,4BAAsB,MAAM,WAAW;AAAA,IACzC,CAAC;AAED,uBAAmB,YAAY,SAAS;AACxC,uBAAmB,YAAY,aAAa;AAG5C,UAAM,kBAAkB,SAAS,cAAc,KAAK;AACpD,oBAAgB,YAAY;AAE5B,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,YAAY;AACnB,UAAM,UAAU,SAAS,cAAc,MAAM;AAC7C,YAAQ,YAAY;AAEpB,UAAM,oBAAoB,MAAM,mBAAmB,MAAM,gBAAgB,KAAK,EAAE;AAChF,QAAI,mBAAmB;AACrB,cAAQ,cAAc;AACtB,aAAO,QAAQ,KAAK,cAAc,KAAK;AAAA,IACzC,OAAO;AACL,cAAQ,cAAc;AACtB,aAAO,QAAQ,KAAK,UAAU,KAAK;AAAA,IACrC;AAEA,WAAO,YAAY,OAAO;AAE1B,UAAM,aAAa,SAAS,cAAc,KAAK;AAC/C,eAAW,YAAY;AACvB,eAAW,iBAAiB,SAAS,OAAO,MAAM;AAChD,QAAE,gBAAgB;AAClB,UAAI;AACF,cAAM,oBAAoB,MAAM,mBAAmB,MAAM,gBAAgB,KAAK,EAAE;AAEhF,YAAI,mBAAmB;AACrB,gBAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,mBAAmB,OAAO,KAAK,GAAG,CAAC;AAC9E,iBAAO,MAAM,gBAAgB,KAAK,EAAE;AACpC,kBAAQ,IAAI,2BAAoB,KAAK,EAAE,EAAE;AAAA,QAC3C,OAAO;AACL,gBAAM,OAAO,KAAK,KAAK,KAAK,IAAI,EAAE,OAAO,EAAE,CAAC;AAE5C,cAAI;AACF,kBAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,yBAAyB,OAAO,KAAK,GAAG,CAAC;AAAA,UACtF,SAAS,QAAQ;AACf,oBAAQ,KAAK,8CAA8C,MAAM;AAAA,UACnE;AAEA,gBAAM,UAAU;AAAA,YACd,KAAK,KAAK;AAAA,YACV,OAAO,KAAK;AAAA,UACd;AACA,gBAAM,OAAO,QAAQ,YAAY;AAAA,YAC/B,QAAQ;AAAA,YACR,OAAO,KAAK;AAAA,YACZ;AAAA,UACF,CAAC;AAED,gBAAM,gBAAgB,KAAK,EAAE,IAAI;AAAA,YAC/B,GAAG;AAAA,YACH,WAAW,KAAK,IAAI;AAAA,UACtB;AACA,kBAAQ,IAAI,yBAAkB,KAAK,EAAE,MAAM,KAAK,KAAK,EAAE;AAAA,QACzD;AAEA,cAAM,YAAY;AAAA,MACpB,SAAS,KAAK;AACZ,gBAAQ,MAAM,6BAA6B,GAAG;AAAA,MAChD;AAAA,IACF,CAAC;AAED,oBAAgB,YAAY,MAAM;AAClC,oBAAgB,YAAY,UAAU;AAGtC,UAAM,oBAAoB,SAAS,cAAc,KAAK;AACtD,sBAAkB,YAAY;AAE9B,UAAM,WAAW,SAAS,cAAc,QAAQ;AAChD,aAAS,YAAY;AACrB,aAAS,cAAc;AAEvB,UAAM,eAAe,SAAS,cAAc,KAAK;AACjD,iBAAa,YAAY;AACzB,iBAAa,iBAAiB,SAAS,CAAC,MAAM;AAC5C,QAAE,gBAAgB;AAClB,6BAAuB,IAAI;AAAA,IAC7B,CAAC;AAED,iBAAa,iBAAiB,cAAc,MAAM;AAChD,UAAI,MAAM,eAAe,OAAO,GAAG;AACjC,iBAAS,QAAQ,KAAK,qBAAqB,CAAC,MAAM,eAAe,KAAK,SAAS,CAAC,CAAC;AAAA,MACnF,OAAO;AACL,iBAAS,QAAQ,KAAK,WAAW;AAAA,MACnC;AAAA,IACF,CAAC;AAED,sBAAkB,YAAY,QAAQ;AACtC,sBAAkB,YAAY,YAAY;AAE1C,qBAAiB,YAAY,kBAAkB;AAC/C,qBAAiB,YAAY,eAAe;AAC5C,qBAAiB,YAAY,iBAAiB;AAE9C,gBAAY,YAAY,gBAAgB;AAGxC,gBAAY,iBAAiB,SAAS,OAAO,MAAM;AACjD,QAAE,gBAAgB;AAClB,cAAQ,IAAI,iBAAiB,KAAK,EAAE,MAAM,KAAK,KAAK,EAAE;AACtD,UAAI;AACF,cAAM,QAAQ,SAAS,eAAe,aAAa;AACnD,cAAM,OAAQ,SAAS,MAAM,QAAQ,MAAM,MAAM,KAAK,IAAI;AAC1D,YAAI,MAAM;AACR,gBAAM,mBAAmB,IAAI;AAAA,QAC/B;AAAA,MACF,SAAS,GAAG;AAAA,MAAC;AAEb,6BAAuB,KAAK,EAAE;AAAA,IAChC,CAAC;AAED,cAAU,YAAY,WAAW;AAGjC,QAAI,KAAK,YAAY,KAAK,SAAS,SAAS,GAAG;AAC7C,YAAM,iBAAiB,CAAC,GAAG,WAAW;AACtC,UAAI,QAAQ,GAAG;AACb,uBAAe,QAAQ,CAAC,IAAI,CAAC;AAAA,MAC/B;AAEA,WAAK,SAAS,QAAQ,CAAC,OAAO,OAAO,UAAU;AAC7C,mBAAW,OAAO,WAAW,QAAQ,GAAG,gBAAgB,UAAU,MAAM,SAAS,CAAC;AAAA,MACpF,CAAC;AAAA,IACH;AAAA,EACF;AAGA,MAAI,yBAAyB,CAAC,WAAW;AAAA,EAAC;AACnC,WAAS,sBAAsB,IAAI;AACxC,6BAAyB;AAAA,EAC3B;;;AChoBA,iBAAsB,qBAAqB,SAAS;AAClD,QAAI;AAAE,YAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,0BAA0B,OAAO,CAAC,CAAC,QAAQ,CAAC;AAAA,IAAG,QAAQ;AAAA,IAAC;AAAA,EAC3G;AAEA,iBAAsB,uBAAuB;AAC3C,QAAI;AACF,YAAM,MAAM,MAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,yBAAyB,CAAC;AACjF,aAAO,CAAC,EAAE,OAAO,IAAI;AAAA,IACvB,QAAQ;AACN,aAAO;AAAA,IACT;AAAA,EACF;AAKA,iBAAsB,oBAAoB;AACxC,QAAI;AACF,YAAM,QAAQ,MAAM,OAAO,QAAQ,MAAM,IAAI,eAAe;AAC5D,YAAM,gBAAgB,MAAM,QAAQ,MAAM,aAAa,IAAI,MAAM,gBAAgB,CAAC;AAAA,IACpF,SAAS,GAAG;AACV,YAAM,gBAAgB,CAAC;AAAA,IACzB;AAAA,EACF;AAEA,iBAAsB,kBAAkB,MAAM;AAC5C,UAAM,KAAK,QAAQ,IAAI,KAAK;AAC5B,QAAI,CAAC,EAAG;AACR,UAAM,gBAAgB,CAAC,GAAG,GAAG,MAAM,cAAc,OAAO,OAAK,MAAM,CAAC,CAAC,EAAE,MAAM,GAAG,EAAE;AAClF,QAAI;AAAE,YAAM,OAAO,QAAQ,MAAM,IAAI,EAAE,eAAe,MAAM,cAAc,CAAC;AAAA,IAAG,QAAQ;AAAA,IAAC;AAAA,EACzF;AAKO,WAAS,mBAAmB;AACjC,UAAM,aAAa,SAAS,eAAe,YAAY;AACvD,QAAI,CAAC,WAAY;AACjB,eAAW,YAAY;AAEvB,UAAM,UAAU,CAAC,OAAO,SAAS;AAC/B,YAAM,OAAO,SAAS,cAAc,MAAM;AAC1C,WAAK,YAAY;AACjB,WAAK,cAAc,QAAQ;AAC3B,YAAM,SAAS,SAAS,cAAc,MAAM;AAC5C,aAAO,YAAY;AACnB,aAAO,cAAc;AACrB,aAAO,QAAQ;AACf,aAAO,iBAAiB,SAAS,OAAO,MAAM;AAC5C,UAAE,gBAAgB;AAClB,YAAI,SAAS,aAAc,OAAM,gBAAgB,aAAa;AAC9D,YAAI,SAAS,UAAU;AACrB,gBAAM,gBAAgB,SAAS;AAC/B,gBAAM,qBAAqB,KAAK;AAAA,QAClC;AACA,YAAI,SAAS,UAAW,OAAM,gBAAgB,cAAc;AAC5D,yBAAiB;AACjB,sBAAc,SAAS,eAAe,aAAa,GAAG,SAAS,EAAE;AAAA,MACnE,CAAC;AACD,WAAK,YAAY,MAAM;AACvB,iBAAW,YAAY,IAAI;AAAA,IAC7B;AAGA,QAAI,MAAM,gBAAgB,OAAQ,SAAQ,KAAK,UAAU,KAAK,UAAU,QAAQ;AAChF,QAAI,MAAM,gBAAgB,WAAY,SAAQ,KAAK,YAAY,KAAK,cAAc,YAAY;AAC9F,QAAI,MAAM,gBAAgB,YAAa,SAAQ,MAAM,gBAAgB,aAAa,SAAS;AAE3F,UAAM,QAAQ,SAAS,eAAe,aAAa;AACnD,QAAI,OAAO;AACT,YAAM,cAAc;AACpB,YAAM,MAAM;AACZ,YAAM,aAAa,WAAW,SAAS,SAAS,IAAI,KAAK,IAAI,WAAW,aAAc,MAAM,cAAc,cAAc,EAAG,IAAI;AAC/H,YAAM,aAAa,aAAa,IAAK,cAAc,aAAa,MAAO;AACvE,YAAM,MAAM,cAAc,aAAa;AAAA,IACzC;AAAA,EACF;AAKO,WAAS,uBAAuB;AACrC,UAAM,YAAY,SAAS,eAAe,gBAAgB;AAC1D,QAAI,CAAC,UAAW;AAChB,cAAU,YAAY;AAEtB,UAAM,WAAW,CAAC,MAAM,YAAY;AAClC,YAAM,KAAK,SAAS,cAAc,MAAM;AACxC,SAAG,YAAY;AACf,SAAG,cAAc;AACjB,SAAG,iBAAiB,aAAa,OAAO,MAAM;AAC5C,UAAE,eAAe;AACjB,cAAM,QAAQ;AAAA,MAChB,CAAC;AACD,aAAO;AAAA,IACT;AAEA,cAAU,YAAY,SAAS,KAAK,UAAU,KAAK,aAAa,YAAY;AAC1E,YAAM,gBAAgB,SAAS,CAAC,MAAM,gBAAgB;AACtD,YAAM,qBAAqB,MAAM,gBAAgB,MAAM;AACvD,YAAM,yBAAyB;AAC/B,uBAAiB;AACjB,oBAAc,SAAS,eAAe,aAAa,GAAG,SAAS,EAAE;AAAA,IACnE,CAAC,CAAC;AAEF,cAAU,YAAY,SAAS,KAAK,YAAY,KAAK,cAAc,YAAY;AAC7E,YAAM,gBAAgB,aAAa,CAAC,MAAM,gBAAgB;AAC1D,uBAAiB;AACjB,oBAAc,SAAS,eAAe,aAAa,GAAG,SAAS,EAAE;AAAA,IACnE,CAAC,CAAC;AAGF,sBAAkB,EAAE,KAAK,MAAM;AAC7B,OAAC,MAAM,iBAAiB,CAAC,GAAG,MAAM,GAAG,CAAC,EAAE,QAAQ,UAAQ;AACtD,YAAI,CAAC,KAAM;AACX,kBAAU,YAAY,SAAS,MAAM,MAAM;AACzC,gBAAM,gBAAgB,cAAc;AACpC,gBAAM,QAAQ,SAAS,eAAe,aAAa;AACnD,cAAI,MAAO,OAAM,QAAQ;AACzB,2BAAiB;AACjB,wBAAc,EAAE;AAAA,QAClB,CAAC,CAAC;AAAA,MACJ,CAAC;AAAA,IACH,CAAC;AACD,cAAU,MAAM,UAAU;AAAA,EAC5B;AAMA,WAAS,cAAc,MAAM;AAC3B,QAAI,CAAC,KAAM,QAAO;AAClB,WAAO,KACJ,YAAY,EACZ,QAAQ,oBAAoB,SAAS,IAAI;AACxC,aAAO,OAAO,aAAa,GAAG,WAAW,CAAC,IAAI,KAAM;AAAA,IACtD,CAAC,EACA,QAAQ,WAAW,GAAG,EACtB,QAAQ,QAAQ,GAAG,EACnB,KAAK;AAAA,EACV;AAEA,WAAS,aAAa,QAAQ;AAC5B,WAAO,OAAO,QAAQ,uBAAuB,MAAM;AAAA,EACrD;AAEA,WAAS,cAAc,SAAS,YAAY;AAC1C,oBAAgB,OAAO;AAEvB,QAAI,CAAC,WAAY;AAEjB,UAAM,OAAO,QAAQ;AACrB,UAAM,iBAAiB,cAAc,IAAI;AACzC,UAAM,uBAAuB,cAAc,UAAU;AACrD,UAAM,QAAQ,eAAe,QAAQ,oBAAoB;AAEzD,QAAI,UAAU,IAAI;AAChB,UAAI,gBAAgB;AACpB,UAAI,iBAAiB,qBAAqB;AAE1C,UAAI,mBAAmB,KAAK,YAAY,GAAG;AACzC,cAAM,UAAU,IAAI,OAAO,aAAa,UAAU,GAAG,GAAG;AACxD,cAAM,QAAQ,KAAK,MAAM,OAAO;AAChC,YAAI,OAAO;AACT,0BAAgB,MAAM;AACtB,2BAAiB,MAAM,CAAC,EAAE;AAAA,QAC5B;AAAA,MACF;AAEA,YAAM,aAAa,KAAK,UAAU,GAAG,aAAa;AAClD,YAAM,YAAY,KAAK,UAAU,eAAe,gBAAgB,cAAc;AAC9E,YAAM,YAAY,KAAK,UAAU,gBAAgB,cAAc;AAE/D,cAAQ,YAAY,aAClB,oCAAoC,YAAY,YAChD;AAAA,IACJ;AAAA,EACF;AAEA,WAAS,gBAAgB,eAAe;AACtC,UAAM,UAAU,cAAc,gBAC5B,cAAc,cAAc,aAAa,IAAI;AAE/C,QAAI,SAAS;AACX,YAAM,aAAa,QAAQ,iBAAiB,mBAAmB;AAC/D,iBAAW,QAAQ,eAAa;AAC9B,cAAM,OAAO,UAAU;AACvB,kBAAU,YAAY,SAAS,eAAe,IAAI,CAAC;AAAA,MACrD,CAAC;AACD,cAAQ,UAAU;AAAA,IACpB;AAAA,EACF;AAEA,WAAS,gBAAgB,MAAM;AAC7B,QAAI,SAAS,KAAK;AAClB,WAAO,UAAU,OAAO,UAAU,SAAS,WAAW,GAAG;AACvD,aAAO,UAAU,OAAO,QAAQ;AAChC,eAAS,OAAO;AAAA,IAClB;AAAA,EACF;AAEA,WAAS,eAAe;AACtB,UAAM,WAAW,SAAS,iBAAiB,YAAY;AACvD,aAAS,QAAQ,UAAQ;AACvB,WAAK,UAAU,OAAO,QAAQ;AAC9B,sBAAgB,IAAI;AAAA,IACtB,CAAC;AAED,UAAM,aAAa,SAAS,iBAAiB,mBAAmB;AAChE,eAAW,QAAQ,SAAO,IAAI,MAAM,UAAU,MAAM;AACpD,8BAA0B;AAAA,EAC5B;AAEA,WAAS,uBAAuB;AAC9B,2BAAuB;AACvB,UAAM,gBAAgB,SAAS,eAAe,eAAe;AAC7D,UAAM,YAAY,SAAS,cAAc,KAAK;AAC9C,cAAU,YAAY;AACtB,cAAU,KAAK;AACf,cAAU,cAAc,2BAA2B,MAAM,iBAAiB;AAC1E,kBAAc,YAAY,SAAS;AAAA,EACrC;AAEA,WAAS,yBAAyB;AAChC,UAAM,WAAW,SAAS,eAAe,WAAW;AACpD,QAAI,UAAU;AACZ,eAAS,OAAO;AAAA,IAClB;AAAA,EACF;AAEA,iBAAe,sBAAsB;AACnC,UAAM,WAAW,SAAS,iBAAiB,YAAY;AACvD,QAAI,oBAAoB;AACxB,QAAI,mBAAmB;AACvB,QAAI,mBAAmB;AAEvB,aAAS,QAAQ,CAAC,MAAM,UAAU;AAChC,YAAM,WAAW,KAAK,cAAc,aAAa;AACjD,YAAM,SAAS,KAAK,aAAa,cAAc,KAAK;AACpD,YAAM,YAAY,WAAW,cAAc,SAAS,WAAW,IAAI;AACnE,YAAM,QAAQ,SAAS,KAAK,aAAa,aAAa,CAAC;AAEvD,YAAM,eAAe,MAAM,oBAAoB,UAAU,SAAS,MAAM,iBAAiB,IAAI;AAC7F,YAAM,aAAa,MAAM,oBAAoB,cAAc,MAAM,EAAE,SAAS,MAAM,iBAAiB,IAAI;AACvG,UAAI,UAAU,gBAAgB;AAE9B,UAAI,WAAW,MAAM,gBAAgB,eAAe,CAAC,MAAM,mBAAmB;AAC5E,cAAM,OAAO,cAAc,MAAM,gBAAgB,WAAW;AAC5D,kBAAU,UAAU,SAAS,IAAI,KAAK,cAAc,MAAM,EAAE,SAAS,IAAI;AAAA,MAC3E;AAEA,UAAI,WAAW,MAAM,gBAAgB,YAAY;AAC/C,cAAM,YAAY,CAAC,MAAM;AAAE,cAAI;AAAE,kBAAM,IAAI,IAAI,IAAI,CAAC;AAAG,cAAE,OAAO;AAAI,mBAAO,EAAE;AAAA,UAAM,QAAQ;AAAE,oBAAQ,KAAG,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,UAAG;AAAA,QAAE;AAC7H,cAAM,OAAO,UAAU,MAAM;AAC7B,YAAI,CAAC,MAAM,qBAAqB,CAAC,MAAM,kBAAkB,IAAI,IAAI,GAAG;AAClE,oBAAU;AAAA,QACZ;AAAA,MACF;AAEA,UAAI,QAAQ,KAAK,MAAM,mBAAmB;AACxC,gBAAQ,IAAI,kBAAW,KAAK,WAAW;AAAA,UACrC,eAAe,WAAW,SAAS,cAAc;AAAA,UACjD,iBAAiB;AAAA,UACjB,YAAY,MAAM;AAAA,UAClB;AAAA,UACA;AAAA,UACA;AAAA,QACF,CAAC;AAAA,MACH;AAEA,UAAI,SAAS;AACX,aAAK,UAAU,OAAO,QAAQ;AAC9B,wBAAgB,IAAI;AACpB,4BAAoB;AAEpB,cAAM,WAAW,MAAM,mBAAmB,MAAM,gBAAgB,KAAK;AACrE,YAAI,UAAU;AACZ,6BAAmB;AAAA,QACrB,OAAO;AACL,6BAAmB;AAAA,QACrB;AAEA,YAAI,gBAAgB,UAAU;AAC5B,wBAAc,UAAU,MAAM,iBAAiB;AAAA,QACjD;AAAA,MACF,OAAO;AACL,aAAK,UAAU,IAAI,QAAQ;AAAA,MAC7B;AAAA,IACF,CAAC;AAED,8BAA0B;AAE1B,WAAO;AAAA,EACT;AAEA,iBAAsB,cAAc,YAAY;AAC9C,UAAM,oBAAoB,cAAc,UAAU;AAElD,YAAQ,IAAI,2BAAoB;AAAA,MAC9B,UAAU;AAAA,MACV,YAAY,MAAM;AAAA,MAClB,QAAQ,MAAM,kBAAkB;AAAA,IAClC,CAAC;AAED,QAAK,MAAM,gBAAgB,UAAW,CAAC,MAAM,sBAAsB;AACjE,UAAI;AACF,cAAM,uBAAuB;AAC7B,cAAM,YAAY;AAAA,MACpB,UAAE;AACA,cAAM,uBAAuB;AAAA,MAC/B;AACA,YAAM,gBAAgB,aAAa,MAAM,gBAAgB;AAAA,IAC3D;AAEA,QAAI,CAAC,cAAc,CAAC,MAAM,gBAAgB,cAAc,CAAC,MAAM,gBAAgB,UAAU,CAAC,MAAM,gBAAgB,aAAa;AAC3H,mBAAa;AACb,6BAAuB;AACvB,yBAAmB;AACnB;AAAA,IACF;AAEA,QAAI,MAAM,gBAAgB,cAAc,CAAC,MAAM,mBAAmB;AAChE,YAAM,uBAAuB;AAAA,IAC/B;AAEA,UAAM,aAAa,MAAM,oBAAoB;AAE7C,QAAI,CAAC,YAAY;AACf,2BAAqB;AAAA,IACvB,OAAO;AACL,6BAAuB;AAAA,IACzB;AACA,uBAAmB;AAAA,EACrB;AAEO,WAAS,cAAc;AAC5B,UAAM,cAAc,SAAS,eAAe,aAAa;AACzD,UAAM,WAAW,SAAS,eAAe,gBAAgB;AAEzD,QAAI,aAAa;AACf,kBAAY,QAAQ;AACpB,kBAAY,MAAM;AAAA,IACpB;AAEA,QAAI,UAAU;AACZ,eAAS,UAAU,OAAO,SAAS;AAAA,IACrC;AAEA,UAAM,oBAAoB;AAC1B,iBAAa;AACb,2BAAuB;AACvB,qBAAiB;AAAA,EACnB;AAEO,WAAS,mBAAmB;AACjC,UAAM,cAAc,SAAS,eAAe,aAAa;AACzD,UAAM,iBAAiB,SAAS,eAAe,gBAAgB;AAE/D,QAAI,CAAC,eAAe,CAAC,eAAgB;AAErC,gBAAY,iBAAiB,SAAS,CAAC,MAAM;AAC3C,YAAM,aAAa,EAAE,OAAO,MAAM,KAAK;AACvC,YAAM,WAAW,SAAS,eAAe,gBAAgB;AACzD,UAAI,YAAY;AACd,iBAAS,UAAU,IAAI,SAAS;AAAA,MAClC,OAAO;AACL,iBAAS,UAAU,OAAO,SAAS;AAAA,MACrC;AACA,oBAAc,UAAU;AAAA,IAC1B,CAAC;AAED,gBAAY,iBAAiB,WAAW,CAAC,MAAM;AAC7C,UAAI,EAAE,QAAQ,UAAU;AACtB,oBAAY;AAAA,MACd;AAAA,IACF,CAAC;AAED,mBAAe,iBAAiB,SAAS,WAAW;AAEpD,eAAW,MAAM;AACf,kBAAY,MAAM;AAAA,IACpB,GAAG,GAAG;AAAA,EACR;;;AC/XO,MAAM,mBAAmB;AAAA,IAC9B,MAAM,eAAe;AACnB,UAAI;AACF,cAAM,cAAc,MAAM,OAAO,QAAQ,YAAY,EAAE,QAAQ,iBAAiB,CAAC;AACjF,eAAO,cAAc,YAAY,gBAAgB,YAAY,QAAQ,SAAS,IAAI;AAAA,MACpF,SAAS,OAAO;AACd,gBAAQ,MAAM,mCAAmC,KAAK;AACtD,eAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAKA,WAASC,eAAc,MAAM;AAC3B,QAAI,CAAC,KAAM,QAAO;AAClB,WAAO,KACJ,YAAY,EACZ,QAAQ,oBAAoB,QAAM,OAAO,aAAa,GAAG,WAAW,CAAC,IAAI,KAAM,CAAC,EAChF,QAAQ,WAAW,GAAG,EACtB,QAAQ,QAAQ,GAAG,EACnB,KAAK;AAAA,EACV;AAEO,WAAS,oBAAoBC,gBAAe;AACjD,WAAO,cAAc;AAAA,MACnB,eAAe,CAAC,SAAS;AACvB,gBAAQ,IAAI,sCAA+B;AAAA,UACzC,UAAU;AAAA,UACV,YAAYD,eAAc,IAAI;AAAA,QAChC,CAAC;AACD,eAAOA,eAAc,IAAI;AAAA,MAC3B;AAAA,MACA,YAAY,CAAC,eAAe;AAC1B,gBAAQ,IAAI,iCAA0B,UAAU;AAChD,QAAAC,eAAc,UAAU;AAAA,MAC1B;AAAA,MACA,cAAc,MAAM;AAClB,cAAM,SAAS,CAAC;AAChB,iBAAS,iBAAiB,aAAa,EAAE,QAAQ,CAAC,IAAI,UAAU;AAC9D,gBAAM,WAAW,GAAG;AACpB,gBAAM,aAAaD,eAAc,QAAQ;AACzC,iBAAO,KAAK,EAAE,OAAO,UAAU,WAAW,CAAC;AAAA,QAC7C,CAAC;AACD,gBAAQ,MAAM,MAAM;AACpB,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO,aAAa;AAAA,MAClB,eAAe,CAAC,SAASA,eAAc,IAAI;AAAA,MAC3C,YAAY,CAAC,SAASC,eAAc,IAAI;AAAA,MACxC,cAAc,MAAM;AAClB,cAAM,SAAS,CAAC;AAChB,iBAAS,iBAAiB,aAAa,EAAE,QAAQ,QAAM;AACrD,iBAAO,KAAK,GAAG,WAAW;AAAA,QAC5B,CAAC;AACD,eAAO;AAAA,MACT;AAAA,MACA,cAAc,MAAM,oBAAoB;AAAA,MACxC,eAAe,MAAM;AACnB,cAAM,OAAO,SAAS;AACtB,cAAM,OAAO,SAAS;AACtB,cAAM,gBAAgB,SAAS,eAAe,eAAe;AAC7D,eAAO;AAAA,UACL,kBAAkB,KAAK;AAAA,UACvB,kBAAkB,KAAK;AAAA,UACvB,kBAAkB,KAAK;AAAA,UACvB,kBAAkB,KAAK;AAAA,UACvB,eAAe,gBAAgB,cAAc,MAAM,YAAY;AAAA,QACjE;AAAA,MACF;AAAA,MACA,YAAY;AAAA,QACV,cAAc,MAAM,iBAAiB,aAAa;AAAA,MACpD;AAAA,MACA,KAAK;AAAA,QACH,OAAO,CAAC,QAAQ,SAAS,GAAG;AAAA,QAC5B,YAAY,MAAM,OAAO,QAAQ,OAAO,qBAAqB;AAAA,QAC7D,UAAU,MAAM;AACd,gBAAM,WAAW;AAAA,YACf;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACF;AACA,kBAAQ,IAAI,mCAA4B;AACxC,kBAAQ,IAAI,2BAAoB,OAAO,QAAQ,OAAO,qBAAqB,CAAC;AAC5E,mBAAS,QAAQ,SAAO;AACtB,kBAAM,SAAS,SAAS,GAAG;AAC3B,oBAAQ,IAAI,GAAG,SAAS,WAAM,QAAG,IAAI,GAAG,WAAM,MAAM,EAAE;AAAA,UACxD,CAAC;AACD,iBAAO,SAAS,IAAI,UAAQ,EAAE,KAAK,OAAO,SAAS,GAAG,EAAE,EAAE;AAAA,QAC5D;AAAA,MACF;AAAA,MACA,WAAW;AAAA,QACT,cAAc,YAAY;AACxB,cAAI;AACF,kBAAM,OAAO,MAAM,OAAO,KAAK,MAAM,CAAC,CAAC;AACvC,kBAAM,aAAa,KAAK,IAAI,UAAQ;AAAA,cAClC,IAAI,IAAI;AAAA,cACR,OAAO,IAAI;AAAA,cACX,KAAK,IAAI;AAAA,cACT,QAAQ,IAAI;AAAA,cACZ,WAAW,IAAI;AAAA,cACf,QAAQ,IAAI;AAAA,cACZ,QAAQ,IAAI,WAAW;AAAA,YACzB,EAAE;AACF,oBAAQ,IAAI,4BAAqB;AACjC,oBAAQ,MAAM,UAAU;AACxB,kBAAM,eAAe,WAAW,OAAO,SAAO,IAAI,aAAa,IAAI,WAAW,UAAU;AACxF,oBAAQ,IAAI,kCAA2B,aAAa,MAAM;AAC1D,mBAAO;AAAA,UACT,SAAS,OAAO;AACd,oBAAQ,MAAM,8BAA8B,KAAK;AACjD,mBAAO,CAAC;AAAA,UACV;AAAA,QACF;AAAA,QACA,oBAAoB,MAAM;AACxB,gBAAM,gBAAgB,SAAS,iBAAiB,qBAAqB;AACrE,gBAAM,WAAW,SAAS,iBAAiB,YAAY;AACvD,kBAAQ,IAAI,oCAA6B,cAAc,QAAQ,KAAK,SAAS,MAAM;AACnF,gBAAM,eAAe,MAAM,KAAK,aAAa,EAAE,IAAI,WAAS;AAAA,YAC1D,OAAO,KAAK,QAAQ;AAAA,YACpB,OAAO,KAAK,cAAc,aAAa,GAAG;AAAA,YAC1C,KAAK,KAAK,QAAQ;AAAA,UACpB,EAAE;AACF,kBAAQ,MAAM,YAAY;AAC1B,iBAAO;AAAA,QACT;AAAA,QACA,uBAAuB,YAAY;AACjC,kBAAQ,IAAI,yCAAkC;AAC9C,gBAAM,YAAY;AAAA,QACpB;AAAA,MACF;AAAA,IACF;AAAA,EACF;;;ACzIA,6BAA2B,iBAAiB;AAC5C,wBAAsB,oBAAoB;AAG1C,WAAS,iBAAiB,oBAAoB,YAAY;AAExD,UAAM,CAAC,SAAS,IAAI,MAAM,OAAO,KAAK,MAAM,EAAE,QAAQ,MAAM,eAAe,KAAK,CAAC;AACjF,QAAI,WAAW;AACb,YAAM,eAAe,UAAU;AAAA,IACjC;AAGA,QAAI,eAAe;AACnB,QAAI;AACF,qBAAe,MAAM,qBAAqB;AAAA,IAC5C,QAAQ;AAAA,IAAC;AAET,QAAI,cAAc;AAChB,YAAM,gBAAgB,SAAS;AAC/B,uBAAiB;AACjB,YAAM,cAAc,SAAS,eAAe,aAAa,GAAG,SAAS,EAAE;AAAA,IACzE,OAAO;AAEL,YAAM,YAAY;AAElB,oBAAc,EAAE;AAAA,IAClB;AAGA,aAAS,eAAe,SAAS,EAAE,iBAAiB,SAAS,YAAY;AACvE,UAAI,OAAO,YAAY;AACrB,cAAM,YAAY,MAAM,OAAO,WAAW,eAAe;AACzD,YAAI,WAAW;AACb,+BAAqB,SAAS;AAAA,QAChC;AAEA,cAAM,wBAAwB;AAAA,MAChC;AAAA,IACF,CAAC;AAED,aAAS,eAAe,YAAY,EAAE,iBAAiB,SAAS,YAAY;AAC1E,UAAI,OAAO,YAAY;AACrB,cAAM,YAAY,MAAM,OAAO,WAAW,WAAW;AACrD,YAAI,WAAW;AACb,+BAAqB,SAAS;AAAA,QAChC;AAEA,cAAM,wBAAwB;AAAA,MAChC;AAAA,IACF,CAAC;AAGD,UAAM,aAAa,SAAS,eAAe,YAAY;AACvD,QAAI,YAAY;AACd,iBAAW,iBAAiB,SAAS,YAAY;AAC/C,cAAM,YAAY;AAAA,MACpB,CAAC;AAAA,IACH;AAGA,aAAS,eAAe,WAAW,EAAE,iBAAiB,SAAS,YAAY;AACzE,UAAI;AACF,YAAI,CAAC,OAAO,sBAAsB;AAChC,gBAAM,eAAe,qBAAqB;AAC1C,iBAAO,uBAAuB;AAAA,QAChC;AACA,cAAM,cAAc;AAAA,MACtB,SAAS,GAAG;AACV,gBAAQ,MAAM,iCAAiC,CAAC;AAAA,MAClD;AAAA,IACF,CAAC;AAGD,aAAS,eAAe,aAAa,EAAE,iBAAiB,SAAS,YAAY;AAC3E,UAAI;AACF,YAAI,CAAC,OAAO,iBAAiB,CAAC,OAAO,eAAe;AAClD,cAAI,CAAC,OAAO,wBAAwB;AAClC,kBAAM,eAAe,4BAA4B;AACjD,mBAAO,yBAAyB;AAAA,UAClC;AAAA,QACF;AAAA,MACF,SAAS,GAAG;AACV,gBAAQ,MAAM,wCAAwC,CAAC;AAAA,MACzD;AACA,YAAM,qBAAqB,OAAO;AAClC,YAAM,wBAAwB,OAAO;AAErC,UAAI,oBAAoB;AACtB,cAAM,YAAY,IAAI,mBAAmB;AACzC,cAAM,UAAU,qBAAqB;AACrC,cAAM,YAAY;AAAA,MACpB,WAAW,uBAAuB;AAChC,cAAM,sBAAsB,qBAAqB;AACjD,cAAM,YAAY;AAAA,MACpB,OAAO;AACL,gBAAQ,MAAM,uDAAuD,OAAO,KAAK,MAAM,EAAE,OAAO,SAAO,IAAI,YAAY,EAAE,SAAS,OAAO,CAAC,CAAC;AAAA,MAC7I;AAAA,IACF,CAAC;AAGD,wBAAoB;AAEpB,UAAM,wBAAwB;AAE9B,aAAS;AAGT,UAAM,cAAc,SAAS,eAAe,aAAa;AACzD,QAAI,aAAa;AACf,kBAAY,iBAAiB,SAAS,MAAM;AAC1C,6BAAqB;AAAA,MACvB,CAAC;AAGD,YAAM,uBAAuB,MAAM;AACjC,YAAI;AAAE,+BAAqB;AAAA,QAAG,QAAQ;AAAA,QAAC;AAAA,MACzC;AACA,kBAAY,iBAAiB,aAAa,oBAAoB;AAC9D,kBAAY,iBAAiB,SAAS,oBAAoB;AAC1D,2BAAqB;AAGrB,kBAAY,iBAAiB,WAAW,OAAO,MAAM;AACnD,YAAI,EAAE,QAAQ,SAAS;AACrB,gBAAM,kBAAkB,YAAY,KAAK;AACzC,+BAAqB;AAAA,QACvB;AAEA,YAAI,EAAE,QAAQ,gBAAgB,YAAY,SAAS,IAAI,KAAK,MAAM,IAAI;AACpE,cAAI,UAAU;AACd,cAAI,MAAM,gBAAgB,aAAa;AACrC,kBAAM,gBAAgB,cAAc;AACpC,sBAAU;AAAA,UACZ,WAAW,MAAM,gBAAgB,QAAQ;AACvC,kBAAM,gBAAgB,SAAS;AAC/B,sBAAU;AAAA,UACZ,WAAW,MAAM,gBAAgB,YAAY;AAC3C,kBAAM,gBAAgB,aAAa;AACnC,sBAAU;AAAA,UACZ;AACA,cAAI,SAAS;AACX,cAAE,eAAe;AACjB,6BAAiB;AACjB,kBAAM,cAAc,EAAE;AAAA,UACxB;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAGA,qBAAiB;AAGjB,wBAAoB,aAAa;AAAA,EACnC,CAAC;AAKD,WAAS,eAAe,KAAK;AAC3B,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAI,SAAS,cAAc,wBAAwB,GAAG,IAAI,GAAG;AAC3D,gBAAQ;AACR;AAAA,MACF;AACA,YAAM,IAAI,SAAS,cAAc,QAAQ;AACzC,QAAE,MAAM;AACR,QAAE,QAAQ;AACV,QAAE,QAAQ;AACV,QAAE,QAAQ,UAAU;AACpB,QAAE,SAAS,MAAM,QAAQ;AACzB,QAAE,UAAU,CAAC,MAAM,OAAO,CAAC;AAC3B,eAAS,KAAK,YAAY,CAAC;AAAA,IAC7B,CAAC;AAAA,EACH;",
  "names": ["node", "normalizeText", "performSearch"]
}
